<interface_config>
  <root id="interface"
        x="0"
        y="0"
        w="800"
        h="600"
        active="true" />
  <lua file="bot_chat_v4.lua" />
  <!--************************-->
  <!--*   BOT CHAT BASICS    *-->
  <!--************************-->
  <!-- thin border template -->
  <template name="thin_bc_border"
            posparent="parent">
    <view type="bitmap"
          id="tlb"
          texture="W_box_top_left.tga"
          posparent="#posparent"
          posref="TL BR" />
    <view type="bitmap"
          id="trb"
          texture="W_box_top_right.tga"
          posparent="#posparent"
          posref="TR BL" />
    <view type="bitmap"
          id="brb"
          texture="W_box_bot_right.tga"
          posparent="#posparent"
          posref="BR TL" />
    <view type="bitmap"
          id="blb"
          texture="W_box_bot_left.tga"
          posparent="#posparent"
          posref="BL TR" />
    <view type="bitmap"
          id="tb"
          texture="W_box_top.tga"
          posparent="#posparent"
          posref="TL BL"
          scale="true"
          sizeref="w"
          w="0"
          h="4" />
    <view type="bitmap"
          id="bb"
          texture="W_box_bot.tga"
          posparent="#posparent"
          posref="BL TL"
          scale="true"
          sizeref="w"
          w="0"
          h="4" />
    <view type="bitmap"
          id="lb"
          texture="W_box_left.tga"
          posparent="#posparent"
          posref="TL TR"
          scale="true"
          sizeref="h"
          h="0"
          w="4" />
    <view type="bitmap"
          id="rb"
          texture="W_box_right.tga"
          posparent="#posparent"
          posref="TR TL"
          scale="true"
          sizeref="h"
          h="0"
          w="4" />
  </template>
  <template name="large_button"
            posparent="parent">
    <view type="bitmap"
          id="sep1"
          posref="TL TL"
          scale="true"
          sizeref="h"
          h="0"
          w="2"
          texture="W_line_ver.tga"
          x="-1" />
    <view type="bitmap"
          id="sep2"
          posref="TR TR"
          scale="true"
          sizeref="h"
          h="0"
          w="2"
          texture="W_line_ver.tga"
          x="1" />
    <view type="bitmap"
          id="sep3"
          posref="TL TL"
          scale="true"
          sizeref="w"
          h="2"
          w="0"
          texture="W_line_hor.tga"
          y="1" />
    <view type="bitmap"
          id="sep4"
          posref="BL BL"
          scale="true"
          sizeref="w"
          h="2"
          w="0"
          texture="W_line_hor.tga"
          y="-1" />
    <view type="bitmap"
          id="sep4"
          posref="BL BL"
          scale="true"
          sizeref="w"
          h="2"
          w="0"
          texture="W_line_hor.tga"
          y="-1" />
  </template>
  <!-- a text with border -->
  <template name="bc_border_text"
            posref="TM TM"
            posparent="parent"
            x="0"
            y="-20"
            w="-4">
    <group id="#id"
           posref="#posref"
           x="#x"
           y="#y"
           posparent="#posparent"
           child_resize_h="true"
           sizeref="w"
           w="#w">
      <!--
                <group id="text" posref="TL TL" x="4" y="-4" child_resize_h="true" sizeref="w" w="-8">
                        <view type="bitmap" id="bg" sizeref="hw" h="0" w="0" scale="true" texture="W_box_blank.tga"/>
                        <view type="text_id_formated" format="$t" id="text" textid="#text_id" multi_line="true" fontsize="12" shadow="true" global_color="false"/>
                </group>
        -->
      <!-- the border -->
      <!--
                <instance template="thin_bc_border" posparent="text"/>
                -->
    </group>
  </template>
  <template name="bc_border_text2"
            posref="TM TM"
            posparent="parent"
            x="0"
            y="0"
            w="-4">
    <group id="#id"
           posref="#posref"
           x="#x"
           y="#y"
           posparent="#posparent"
           child_resize_h="true"
           w="#w">
      <group id="text"
             posref="TL TL"
             x="4"
             y="-4"
             child_resize_h="true"
             sizeref="w"
             w="-8">
        <view type="bitmap"
              id="bg"
              sizeref="hw"
              h="0"
              w="0"
              scale="true"
              texture="W_box_blank.tga" />
        <view type="text_id_formated"
              format="$t"
              id="text"
              textid="#text_id"
              multi_line="true"
              fontsize="12"
              shadow="true"
              global_color="false" />
      </group>
      <!-- the border -->
      <instance template="thin_bc_border"
                posparent="text" />
    </group>
  </template>
  <!-- EXCHANGE slot -->
  <style style="xchg_slot"
         type="sheet"
         onclick_r="open_help_auto"
         dragable="true"
         oncandrop="can_drop_to_exchange"
         ondrop="proc"
         params_drop="drop_item"
         oncannotdrop="put_exchange_item_to_bag"
         selection_group="inventory_selection"
         onclick_l="exchange_left_click_on_slot" />
  <!-- Basic container style -->
  <style style="bot_chat_window"
         type="container"
         openable="false"
         opened="true"
         movable="true"
         resizer="false"
         savable="false"
         header_color="UI:SAVE:WIN:COLORS:BOT"
         global_color="false"
         escapable="true"
         on_close_button="close_bot_chat_program"
         on_escape="close_bot_chat_program" />
  <!-- ************************************** -->
  <!-- *     BOT CHAT PAGE FOR PLAYER GIFT  * -->
  <!-- ************************************** -->
  <group id="bot_chat_player_gift"
         style="bot_chat_window"
         posref="BL TL"
         min_w="212"
         max_w="212"
         w="212"
         x="352"
         y="200"
         active="false"
         max_h="208"
         on_active="proc"
         on_active_params="memorize_inventory_state"
         on_deactive="restore_inventory_state"
         title="uiBotChatOffer">
    <group id="header_opened"
           h="188"
           w="196"
           x="16"
           y="-8"
           posref="TL TL">
      <!-- 1 / INTRO -->
      <instance template="bc_border_text"
                id="intro"
                text_id="SERVER:BOTCHAT:PLAYER_GIFT" />
      <group id="give_content"
             posparent="intro"
             posref="BL TL"
             child_resize_h="true"
             sizeref="w"
             w="0"
             y="-4">
        <!--
                        <instance template="box_widget" id="give_back" posref="TM TM" w="184" h="148" x="0" y="0"/>
                        <view type="text" id="give_text" posref="TL TL" posparent="give_back" x="4" y="-4" color="255 255 255 255" fontsize="11" shadow="true" hardtext="uiPlayerGive" global_color="true" />
                        -->
        <group id="give"
               posref="TM TM"
               x="0"
               y="0"
               w="184"
               h="144">
          <!-- Money to give -->
          <view type="text"
                id="money_r"
                posref="TL TL"
                x="0"
                y="0"
                color="255 255 255 255"
                fontsize="10"
                shadow="true"
                hardtext="uiMoneyTitle" />
          <instance template="argent"
                    id="money_given"
                    posref="TL TL"
                    x="24"
                    y="-14"
                    value="%money_proposal" />
          <!-- Set money -->
          <view type="bitmap"
                id="sep"
                posparent="money_given"
                posref="TR TL"
                x="8"
                y="14"
                scale="true"
                h="36"
                w="2"
                texture="W_line_ver.tga" />
          <!-- Set money -->
          <ctrl type="button"
                id="choose_money"
                button_type="push_button"
                posparent="sep"
                posref="BR BL"
                y="0"
                x="4"
                tx_normal="w_button_edit.tga"
                tx_pushed="w_button_edit.tga"
                tx_over="W_button_16_over.tga"
                onclick_l="enter_modal"
                params_l="group=ui:interface:money_choose_dialog"
                tooltip="uittSetMoney" />
          <!-- Reset money -->
          <ctrl type="button"
                id="reset_money"
                button_type="push_button"
                posparent="choose_money"
                posref="TL BL"
                y="1"
                x="0"
                tx_normal="w_button_reset.tga"
                tx_pushed="w_button_reset.tga"
                tx_over="W_button_16_over.tga"
                onclick_l="proc"
                params_l="reset_money_quantity"
                tooltip="uittClearMoney" />
          <!-- Items to give -->
          <group id="given_items"
                 posref="TL TL"
                 x="5"
                 y="-52"
                 h="86"
                 w="180">
            <!-- 8 sheets that can't be drag and dropped -->
            <ctrl style="xchg_slot"
                  id="slot0"
                  posparent="parent"
                  posref="TL TL"
                  x="0"
                  value="%exchange_give:0"
                  onclick_r="open_help_auto" />
            <ctrl style="xchg_slot"
                  id="slot1"
                  posparent="slot0"
                  posref="TR TL"
                  x="2"
                  value="%exchange_give:1"
                  onclick_r="open_help_auto" />
            <ctrl style="xchg_slot"
                  id="slot2"
                  posparent="slot1"
                  posref="TR TL"
                  x="2"
                  value="%exchange_give:2"
                  onclick_r="open_help_auto" />
            <ctrl style="xchg_slot"
                  id="slot3"
                  posparent="slot2"
                  posref="TR TL"
                  x="2"
                  value="%exchange_give:3"
                  onclick_r="open_help_auto" />
            <ctrl style="xchg_slot"
                  id="slot4"
                  posparent="slot0"
                  posref="BL TL"
                  x="0"
                  y="-2"
                  value="%exchange_give:4"
                  onclick_r="open_help_auto" />
            <ctrl style="xchg_slot"
                  id="slot5"
                  posparent="slot4"
                  posref="TR TL"
                  x="2"
                  value="%exchange_give:5"
                  onclick_r="open_help_auto" />
            <ctrl style="xchg_slot"
                  id="slot6"
                  posparent="slot5"
                  posref="TR TL"
                  x="2"
                  value="%exchange_give:6"
                  onclick_r="open_help_auto" />
            <ctrl style="xchg_slot"
                  id="slot7"
                  posparent="slot6"
                  posref="TR TL"
                  x="2"
                  value="%exchange_give:7"
                  onclick_r="open_help_auto" />
          </group>
          <view type="text"
                id="items_r"
                posref="TL TL"
                x="2"
                y="-40"
                color="255 255 255 255"
                fontsize="10"
                shadow="true"
                hardtext="uiItems" />
        </group>
        <!-- give -->
        <!-- ctrl to validate the transaction -->
        <group id="confirm_trade"
               posparent="give"
               posref="BR TR"
               x="0"
               y="0"
               child_resize_h="true"
               child_resize_w="true">
          <group id="visbut"
                 child_resize_h="true"
                 child_resize_w="true"
                 posref="TR TR">
            <instance template="button_ok_cancel"
                      posref="TR TR"
                      ok_text="uimGive"
                      onclick_ok="valid_player_gift"
                      onclick_ok_param=""
                      onclick_cancel="close_bot_chat_program"
                      onclick_cancel_param="" />
            <!-- link to know when the request is valid -->
            <link expr="not(@%exchange_accepted)"
                  target="ok_cancel:ok:frozen" />
          </group>
        </group>
      </group>
    </group>
  </group>
  <!-- ************************************** -->
  <!-- *     BOT CHAT PAGE FOR CREATE GUILD * -->
  <!-- ************************************** -->
  <variable entry="UI:TEMP:GUILD_CREATION:ICON"
            type="sint64"
            value="13" />
  <variable entry="UI:TEMP:GUILD_CREATION:NAME"
            type="sint64"
            value="0" />
  <variable entry="UI:TEMP:GUILD_CREATION:COLOR1"
            type="rgba"
            value="80 133 33 255" />
  <variable entry="UI:TEMP:GUILD_CREATION:COLOR2"
            type="rgba"
            value="196 233 48 255" />
  <variable entry="UI:TEMP:GUILD_CREATION:INV_SYMB"
            type="bool"
            value="0" />
  <variable entry="UI:TEMP:GUILD:BACK:ICON"
            type="sint64"
            value="13" />
  <variable entry="UI:TEMP:GUILD:BACK:NAME"
            type="sint64"
            value="0" />
  <!-- INIT FLAGS CREATION PARAMS -->
  <proc id="init_guild_creation">
    <action handler="set"
            params="dblink=UI:TEMP:GUILD_CREATION:COLOR1|value=makeRGB(80,133,33,254)" />
    <action handler="set"
            params="dblink=UI:TEMP:GUILD_CREATION:COLOR2|value=makeRGB(196,233,48,254)" />
    <action handler="set"
            params="dblink=UI:TEMP:GUILD_CREATION:COLOR1|value=makeRGB(80,133,33,255)" />
    <action handler="set"
            params="dblink=UI:TEMP:GUILD_CREATION:COLOR2|value=makeRGB(196,233,48,255)" />
    <action handler="set"
            params="dblink=UI:TEMP:GUILD_CREATION:ICON|value=13" />
    <action handler="set"
            params="dblink=UI:TEMP:GUILD:BACK:ICON|value=13" />
    <action handler="set"
            params="dblink=UI:TEMP:GUILD_CREATION:INV_SYMB|value=0" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:blason:symbol|value=9" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:fore_layer:texture|value='Guild_Symbol_S_08.tga'" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:edit:eb:input_string|value=''" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:desc:eb:input_string|value=''" />
    <action handler="ddx_init"
            params="ui:interface:bot_chat_create_guild:content:all" />
  </proc>
  <group id="bot_chat_create_guild"
         style="bot_chat_window"
         posref="BL TL"
         w="254"
         x="352"
         y="200"
         active="false"
         max_h="2000"
         title="uiBotCreateGuild"
         child_resize_hmargin="16"
         on_active="proc"
         on_active_params="init_guild_creation">
    <group id="header_closed"
           x="0"
           y="0"
           w="#w"
           h="16"
           posref="TL TL"></group>
    <group id="header_opened"
           x="0"
           y="0"
           w="#w"
           h="16"
           posref="TL TL"></group>
    <group id="content"
           w="246"
           child_resize_h="true"
           child_resize_hmargin="4"
           x="0"
           y="0"
           posref="TL TL">
      <!-- 1 / INTRO -->
      <instance template="bc_border_text"
                id="intro"
                w="0"
                y="-4"
                text_id="SERVER:BOTCHAT:CREATE_GUILD" />
      <!-- GUILD ICON -->
      <ctrl type="sheet"
            id="blason"
            posref="BL TL"
            x="0"
            y="-16"
            posparent="intro"
            nature="guild_flag"
            value="UI:TEMP:GUILD_CREATION"
            dragable="false"
            color="255 255 255 255" />
      <view type="text"
            id="guild_blason"
            posref="TL BL"
            posparent="blason"
            x="0"
            y="0"
            color="255 255 255 255"
            fontsize="10"
            shadow="true"
            hardtext="uiGuildBlason" />
      <!-- NAME OF GUILD -->
      <instance template="edit_box_widget"
                id="edit"
                posparent="blason"
                posref="MR ML"
                x="4"
                w="200"
                y="0"
                h="20"
                text_x="0"
                text_y="-1"
                text_ref="ML ML"
                fontsize="12"
                prompt=""
                enter_loose_focus="true"
                multi_line="false"
                max_num_chars="32"
                onenter=""
                params=""
                enter_recover_focus="false"
                reset_focus_on_hide="true"
                max_historic="0"
                entry_type="text" />
      <view type="text"
            id="guild_name"
            posparent="edit"
            posref="TL BL"
            x="0"
            y="5"
            color="255 255 255 255"
            fontsize="10"
            shadow="true"
            hardtext="uiGuildName" />
      <!-- DESCRIPTION -->
      <instance template="edit_box_widget"
                id="desc"
                posref="BL TL"
                y="-24"
                posparent="blason"
                child_resize_h="true"
                w="238"
                onenter="" />
      <view type="text"
            id="guild_desc"
            posparent="desc"
            posref="TL BL"
            x="0"
            y="0"
            color="255 255 255 255"
            fontsize="10"
            shadow="true"
            hardtext="uiGuildDescription" />
      <!-- BLASON DESIGN -->
      <instance template="box_widget"
                id="back"
                posparent="desc"
                posref="BM TM"
                w="180"
                h="77"
                x="0"
                y="-24" />
      <view type="text"
            id="guild_blason_design"
            posref="TL BL"
            posparent="back"
            x="0"
            y="0"
            color="255 255 255 255"
            fontsize="10"
            shadow="true"
            hardtext="uiGuildBlasonDesign" />
      <ctrl type="sheet"
            id="back_layer"
            posref="TL TL"
            x="4"
            y="-18"
            posparent="back"
            nature="guild_flag"
            value="UI:TEMP:GUILD:BACK"
            global_color="false"
            onclick_l="enter_modal"
            params_l="group=ui:interface:guild_flag_back" />
      <view type="bitmap"
            id="fore_sheet"
            posparent="back_layer"
            posref="TR TL"
            x="4"
            y="0"
            texture="W_slot_blason.tga" />
      <view type="text"
            id="blason_back"
            posref="TL BL"
            posparent="back_layer"
            x="0"
            y="0"
            color="255 255 255 255"
            fontsize="10"
            shadow="true"
            hardtext="uiGuildBlasonBack" />
      <view type="text"
            id="blason_fore"
            posref="TL BL"
            posparent="fore_sheet"
            x="0"
            y="0"
            color="255 255 255 255"
            fontsize="10"
            shadow="true"
            hardtext="uiGuildBlasonFore" />
      <ctrl type="button"
            button_type="push_button"
            id="fore_flag"
            posparent="fore_sheet"
            posref="TL TL"
            tx_normal="W_slot_blason_over.tga"
            tx_over="W_slot_blason_over.tga"
            tx_pushed="W_slot_blason_over.tga"
            color="255 255 255 0"
            col_over="255 255 255 255"
            col_pushed="255 255 255 0"
            global_color_over="true"
            onclick_l="enter_modal"
            params_l="group=ui:interface:guild_flag_fore" />
      <view type="bitmap"
            id="fore_layer"
            posref="TL TL"
            x="1"
            y="-1"
            render_layer="5"
            posparent="fore_sheet"
            texture="Guild_Symbol_S_08.tga"
            scale="true"
            w="32"
            h="32"
            global_color="false" />
      <instance template="tgcw_color2"
                id="col_1"
                text="uiGuildBlasonC1"
                title="uiGuildBlasonColor1"
                tooltip="uiGuildBlasonColor1"
                posref="TL TL"
                posparent="back"
                x="80"
                y="-19" />
      <instance template="tgcw_color2"
                id="col_2"
                text="uiGuildBlasonC2"
                title="uiGuildBlasonColor2"
                tooltip="uiGuildBlasonColor2"
                posref="BL TL"
                posparent="col_1"
                x="0"
                y="-4" />
      <instance template="tgcw_checkbox2"
                id="negative"
                text="uiNegativeSymbol"
                posparent="back"
                posref="BM BM"
                x="0"
                y="4" />
      <group id="pipo"
             w="238"
             h="8"
             x="0"
             y="0"
             posparent="back"
             posref="BM TM" />
      <instance template="button_ok_cancel"
                posparent="pipo"
                posref="BR TR"
                x="-4"
                y="-4"
                ok_text="uiBotCreateGuild"
                onclick_ok="enter_guild_creation"
                onclick_ok_param="guild=ui:interface:bot_chat_create_guild:content:edit:eb|icon=ui:interface:bot_chat_create_guild:content:blason|desc=ui:interface:bot_chat_create_guild:content:desc:eb"
                onclick_cancel="close_bot_chat_program"
                onclick_cancel_param="" />
      <ddx id="all">
        <param ui="col_1:c"
               type="db"
               widget="colbut"
               link="UI:TEMP:GUILD_CREATION:COLOR1"
               realtime="true" />
        <param ui="col_2:c"
               type="db"
               widget="colbut"
               link="UI:TEMP:GUILD_CREATION:COLOR2"
               realtime="true" />
        <param ui="negative:c"
               type="db"
               widget="boolbut"
               link="UI:TEMP:GUILD_CREATION:INV_SYMB"
               realtime="true" />
      </ddx>
      <link expr="depends(@UI:TEMP:GUILD_CREATION:COLOR1)"
            action="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:blason:color1|value=@UI:TEMP:GUILD_CREATION:COLOR1" />
      <link expr="depends(@UI:TEMP:GUILD_CREATION:COLOR2)"
            action="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:blason:color2|value=@UI:TEMP:GUILD_CREATION:COLOR2" />
      <link expr="depends(@UI:TEMP:GUILD_CREATION:COLOR1)"
            action="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:back_layer:color1|value=@UI:TEMP:GUILD_CREATION:COLOR1" />
      <link expr="depends(@UI:TEMP:GUILD_CREATION:COLOR2)"
            action="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:back_layer:color2|value=@UI:TEMP:GUILD_CREATION:COLOR2" />
      <link expr="depends(@UI:TEMP:GUILD_CREATION:INV_SYMB)"
            action="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:blason:invert_symbol|value=@UI:TEMP:GUILD_CREATION:INV_SYMB" />
    </group>
  </group>
  <!-- Template that define slots -->
  <template name="flag_sheet"
            id=""
            posparent="parent"
            posref="TL TL"
            x="0"
            y="0"
            w="0"
            h="34">
    <group id="#id"
           x="#x"
           y="#y"
           posparent="#posparent"
           posref="#posref"
           sizeref="w"
           h="#h">
      <view type="bitmap"
            id="sht1"
            posref="TL TL"
            x="0"
            y="0"
            texture="W_slot_blason.tga" />
      <view type="bitmap"
            id="sht2"
            posparent="sht1"
            posref="TR TL"
            x="4"
            y="0"
            texture="W_slot_blason.tga" />
      <view type="bitmap"
            id="sht3"
            posparent="sht2"
            posref="TR TL"
            x="4"
            y="0"
            texture="W_slot_blason.tga" />
      <view type="bitmap"
            id="sht4"
            posparent="sht3"
            posref="TR TL"
            x="4"
            y="0"
            texture="W_slot_blason.tga" />
      <view type="bitmap"
            id="sht5"
            posparent="sht4"
            posref="TR TL"
            x="4"
            y="0"
            texture="W_slot_blason.tga" />
    </group>
  </template>
  <proc id="change_flag_back">
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:blason:back|value=add(@0,1)" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:back_layer:back|value=add(@0,1)" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:back_layer:symbol|value=0" />
  </proc>
  <!-- Template that define images -->
  <variable entry="UI:TEMP:GUILD_CREA_BACK:$i:ICON"
            type="sint32"
            value="0"
            size="15" />
  <variable entry="UI:TEMP:GUILD_CREA_BACK:$i:NAME"
            type="sint32"
            value="0"
            size="15" />
  <template name="flag_back"
            id=""
            posparent="parent"
            posref="TL TL"
            x="0"
            y="0"
            w="0"
            h="34"
            texture=""
            value="">
    <group id="#id"
           x="#x"
           y="#y"
           posparent="#posparent"
           posref="#posref"
           sizeref="w"
           h="#h"
           texture="#texture"
           value="#value">
      <ctrl type="sheet"
            id="image1"
            posref="TL TL"
            x="0"
            y="0"
            nature="guild_flag"
            value="UI:TEMP:GUILD_CREA_BACK:#value"
            dragable="false"
            color="255 255 255 255" />
      <ctrl type="button"
            button_type="push_button"
            id="but1"
            posref="TL TL"
            tx_normal="W_slot_blason_over.tga"
            tx_over="W_slot_blason_over.tga"
            tx_pushed="W_slot_blason_over.tga"
            color="255 255 255 0"
            col_over="255 255 255 255"
            col_pushed="255 255 255 255"
            onclick_l="proc"
            params_l="change_flag_back|#value" />
    </group>
  </template>
  <proc id="change_flag_symbol">
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:blason:symbol|value=@0" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_create_guild:content:fore_layer:texture|value='@1'" />
  </proc>
  <template name="flag_symbol"
            id=""
            posparent="parent"
            posref="TL TL"
            x="0"
            y="0"
            w="0"
            h="34"
            texture=""
            value="">
    <group id="#id"
           x="#x"
           y="#y"
           posparent="#posparent"
           posref="#posref"
           sizeref="w"
           h="#h"
           texture="#texture"
           value="#value">
      <view type="bitmap"
            id="image1"
            posref="TL TL"
            x="1"
            y="-1"
            render_layer="5"
            texture="#texture"
            global_color="false" />
      <ctrl type="button"
            button_type="push_button"
            id="but1"
            posref="TL TL"
            tx_normal="W_slot_blason_over.tga"
            tx_over="W_slot_blason_over.tga"
            tx_pushed="W_slot_blason_over.tga"
            color="255 255 255 0"
            col_over="255 255 255 255"
            col_pushed="255 255 255 255"
            onclick_l="proc"
            params_l="change_flag_symbol|#value|#texture" />
    </group>
  </template>
  <!-- FLAG BACK MODAL -->
  <group type="modal"
         id="guild_flag_back"
         exit_click_out="true"
         posref="BM TM"
         w="194"
         child_resize_h="true"
         child_resize_hmargin="8"
         h="0"
         lua_class="game:bcCreateGuildInitFlags()"
         exit_click_l="true"
         options="skin_modal">
    <instance template="flag_sheet"
              id="sheet1"
              posref="TL TL"
              x="4"
              y="-4" />
    <instance template="flag_sheet"
              id="sheet2"
              posref="TL TL"
              x="4"
              y="-42" />
    <instance template="flag_sheet"
              id="sheet3"
              posref="TL TL"
              x="4"
              y="-80" />
    <instance template="flag_back"
              id="back0"
              posref="TL TL"
              x="4"
              y="-4"
              value="0" />
    <instance template="flag_back"
              id="back1"
              posref="TL TL"
              x="42"
              y="-4"
              value="1" />
    <instance template="flag_back"
              id="back2"
              posref="TL TL"
              x="80"
              y="-4"
              value="2" />
    <instance template="flag_back"
              id="back3"
              posref="TL TL"
              x="118"
              y="-4"
              value="3" />
    <instance template="flag_back"
              id="back4"
              posref="TL TL"
              x="156"
              y="-4"
              value="4" />
    <instance template="flag_back"
              id="back5"
              posref="TL TL"
              x="4"
              y="-42"
              value="5" />
    <instance template="flag_back"
              id="back6"
              posref="TL TL"
              x="42"
              y="-42"
              value="6" />
    <instance template="flag_back"
              id="back7"
              posref="TL TL"
              x="80"
              y="-42"
              value="7" />
    <instance template="flag_back"
              id="back8"
              posref="TL TL"
              x="118"
              y="-42"
              value="8" />
    <instance template="flag_back"
              id="back9"
              posref="TL TL"
              x="156"
              y="-42"
              value="9" />
    <instance template="flag_back"
              id="back10"
              posref="TL TL"
              x="4"
              y="-80"
              value="10" />
    <instance template="flag_back"
              id="back11"
              posref="TL TL"
              x="42"
              y="-80"
              value="11" />
    <instance template="flag_back"
              id="back12"
              posref="TL TL"
              x="80"
              y="-80"
              value="12" />
    <instance template="flag_back"
              id="back13"
              posref="TL TL"
              x="118"
              y="-80"
              value="13" />
    <instance template="flag_back"
              id="back14"
              posref="TL TL"
              x="156"
              y="-80"
              value="14" />
  </group>
  <!-- FLAG SYMBOL MODAL -->
  <group type="modal"
         id="guild_flag_fore"
         exit_click_out="true"
         posref="BM TM"
         w="232"
         child_resize_h="true"
         child_resize_hmargin="8"
         h="0"
         on_active=""
         on_active_params=""
         exit_click_l="true"
         options="skin_modal">
    <instance template="flag_sheet"
              id="sheet1"
              posref="TL TL"
              x="4"
              y="-4" />
    <instance template="flag_symbol"
              id="back0"
              posref="TL TL"
              x="4"
              y="-4"
              value="1"
              texture="Guild_Symbol_S_00.tga" />
    <instance template="flag_symbol"
              id="back1"
              posref="TL TL"
              x="42"
              y="-4"
              value="2"
              texture="Guild_Symbol_S_01.tga" />
    <instance template="flag_symbol"
              id="back2"
              posref="TL TL"
              x="80"
              y="-4"
              value="3"
              texture="Guild_Symbol_S_02.tga" />
    <instance template="flag_symbol"
              id="back3"
              posref="TL TL"
              x="118"
              y="-4"
              value="4"
              texture="Guild_Symbol_S_03.tga" />
    <instance template="flag_symbol"
              id="back4"
              posref="TL TL"
              x="156"
              y="-4"
              value="5"
              texture="Guild_Symbol_S_04.tga" />
    <instance template="flag_symbol"
              id="back5"
              posref="TL TL"
              x="194"
              y="-4"
              value="6"
              texture="Guild_Symbol_S_05.tga" />
    <instance template="flag_sheet"
              id="sheet2"
              posref="TL TL"
              x="4"
              y="-42" />
    <instance template="flag_symbol"
              id="back6"
              posref="TL TL"
              x="4"
              y="-42"
              value="7"
              texture="Guild_Symbol_S_06.tga" />
    <instance template="flag_symbol"
              id="back7"
              posref="TL TL"
              x="42"
              y="-42"
              value="8"
              texture="Guild_Symbol_S_07.tga" />
    <instance template="flag_symbol"
              id="back8"
              posref="TL TL"
              x="80"
              y="-42"
              value="9"
              texture="Guild_Symbol_S_08.tga" />
    <instance template="flag_symbol"
              id="back9"
              posref="TL TL"
              x="118"
              y="-42"
              value="10"
              texture="Guild_Symbol_S_09.tga" />
    <instance template="flag_symbol"
              id="back10"
              posref="TL TL"
              x="156"
              y="-42"
              value="11"
              texture="Guild_Symbol_S_10.tga" />
    <instance template="flag_symbol"
              id="back11"
              posref="TL TL"
              x="194"
              y="-42"
              value="12"
              texture="Guild_Symbol_S_11.tga" />
    <instance template="flag_sheet"
              id="sheet3"
              posref="TL TL"
              x="4"
              y="-80" />
    <instance template="flag_symbol"
              id="back12"
              posref="TL TL"
              x="4"
              y="-80"
              value="13"
              texture="Guild_Symbol_S_12.tga" />
    <instance template="flag_symbol"
              id="back13"
              posref="TL TL"
              x="42"
              y="-80"
              value="14"
              texture="Guild_Symbol_S_13.tga" />
    <instance template="flag_symbol"
              id="back14"
              posref="TL TL"
              x="80"
              y="-80"
              value="15"
              texture="Guild_Symbol_S_14.tga" />
    <instance template="flag_symbol"
              id="back15"
              posref="TL TL"
              x="118"
              y="-80"
              value="16"
              texture="Guild_Symbol_S_15.tga" />
    <instance template="flag_symbol"
              id="back16"
              posref="TL TL"
              x="156"
              y="-80"
              value="17"
              texture="Guild_Symbol_S_16.tga" />
    <instance template="flag_symbol"
              id="back17"
              posref="TL TL"
              x="194"
              y="-80"
              value="18"
              texture="Guild_Symbol_S_17.tga" />
    <instance template="flag_sheet"
              id="sheet4"
              posref="TL TL"
              x="4"
              y="-118" />
    <instance template="flag_symbol"
              id="back18"
              posref="TL TL"
              x="4"
              y="-118"
              value="19"
              texture="Guild_Symbol_S_18.tga" />
    <instance template="flag_symbol"
              id="back19"
              posref="TL TL"
              x="42"
              y="-118"
              value="20"
              texture="Guild_Symbol_S_19.tga" />
    <instance template="flag_symbol"
              id="back20"
              posref="TL TL"
              x="80"
              y="-118"
              value="21"
              texture="Guild_Symbol_S_20.tga" />
    <instance template="flag_symbol"
              id="back21"
              posref="TL TL"
              x="118"
              y="-118"
              value="22"
              texture="Guild_Symbol_S_21.tga" />
    <instance template="flag_symbol"
              id="back22"
              posref="TL TL"
              x="156"
              y="-118"
              value="23"
              texture="Guild_Symbol_S_22.tga" />
    <instance template="flag_symbol"
              id="back23"
              posref="TL TL"
              x="194"
              y="-118"
              value="24"
              texture="Guild_Symbol_S_23.tga" />
    <instance template="flag_sheet"
              id="sheet5"
              posref="TL TL"
              x="4"
              y="-156" />
    <instance template="flag_symbol"
              id="back24"
              posref="TL TL"
              x="4"
              y="-156"
              value="25"
              texture="Guild_Symbol_S_24.tga" />
    <instance template="flag_symbol"
              id="back25"
              posref="TL TL"
              x="42"
              y="-156"
              value="26"
              texture="Guild_Symbol_S_25.tga" />
    <instance template="flag_symbol"
              id="back26"
              posref="TL TL"
              x="80"
              y="-156"
              value="27"
              texture="Guild_Symbol_S_26.tga" />
    <instance template="flag_symbol"
              id="back27"
              posref="TL TL"
              x="118"
              y="-156"
              value="28"
              texture="Guild_Symbol_S_27.tga" />
    <instance template="flag_symbol"
              id="back28"
              posref="TL TL"
              x="156"
              y="-156"
              value="29"
              texture="Guild_Symbol_S_28.tga" />
    <instance template="flag_symbol"
              id="back29"
              posref="TL TL"
              x="194"
              y="-156"
              value="30"
              texture="Guild_Symbol_S_29.tga" />
    <instance template="flag_sheet"
              id="sheet6"
              posref="TL TL"
              x="4"
              y="-194" />
    <instance template="flag_symbol"
              id="back30"
              posref="TL TL"
              x="4"
              y="-194"
              value="31"
              texture="Guild_Symbol_S_30.tga" />
    <instance template="flag_symbol"
              id="back31"
              posref="TL TL"
              x="42"
              y="-194"
              value="32"
              texture="Guild_Symbol_S_31.tga" />
    <instance template="flag_symbol"
              id="back32"
              posref="TL TL"
              x="80"
              y="-194"
              value="33"
              texture="Guild_Symbol_S_32.tga" />
    <instance template="flag_symbol"
              id="back33"
              posref="TL TL"
              x="118"
              y="-194"
              value="34"
              texture="Guild_Symbol_S_33.tga" />
    <instance template="flag_symbol"
              id="back34"
              posref="TL TL"
              x="156"
              y="-194"
              value="35"
              texture="Guild_Symbol_S_34.tga" />
    <instance template="flag_symbol"
              id="back35"
              posref="TL TL"
              x="194"
              y="-194"
              value="36"
              texture="Guild_Symbol_S_35.tga" />
    <instance template="flag_sheet"
              id="sheet7"
              posref="TL TL"
              x="4"
              y="-232" />
    <instance template="flag_symbol"
              id="back36"
              posref="TL TL"
              x="4"
              y="-232"
              value="37"
              texture="Guild_Symbol_S_36.tga" />
    <instance template="flag_symbol"
              id="back37"
              posref="TL TL"
              x="42"
              y="-232"
              value="38"
              texture="Guild_Symbol_S_37.tga" />
    <instance template="flag_symbol"
              id="back38"
              posref="TL TL"
              x="80"
              y="-232"
              value="39"
              texture="Guild_Symbol_S_38.tga" />
    <instance template="flag_symbol"
              id="back39"
              posref="TL TL"
              x="118"
              y="-232"
              value="40"
              texture="Guild_Symbol_S_39.tga" />
    <instance template="flag_symbol"
              id="back40"
              posref="TL TL"
              x="156"
              y="-232"
              value="41"
              texture="Guild_Symbol_S_40.tga" />
    <instance template="flag_symbol"
              id="back41"
              posref="TL TL"
              x="194"
              y="-232"
              value="42"
              texture="Guild_Symbol_S_41.tga" />
    <instance template="flag_sheet"
              id="sheet8"
              posref="TL TL"
              x="4"
              y="-270" />
    <instance template="flag_symbol"
              id="back42"
              posref="TL TL"
              x="4"
              y="-270"
              value="43"
              texture="Guild_Symbol_S_42.tga" />
    <instance template="flag_symbol"
              id="back43"
              posref="TL TL"
              x="42"
              y="-270"
              value="44"
              texture="Guild_Symbol_S_43.tga" />
  </group>
  <!-- ******************************** -->
  <!-- *     BOT CHAT TRADE MODAL     * -->
  <!-- ******************************** -->
  <!-- price of current selected item -->
  <variable entry="UI:SAVE:TRADE_ITEM:RESALE_MARGIN"
            type="sint32"
            value="100" />
  <variable entry="UI:TEMP:TRADE_ITEM:UNIT_PRICE"
            type="sint64"
            value="-1" />
  <variable entry="UI:TEMP:TRADE_ITEM:UNIT_PRICE_WITH_FAME"
            type="sint64"
            value="-1" />
  <variable entry="UI:TEMP:TRADE_ITEM:UNIT_PRICE_RESALE"
            type="sint64"
            value="-1" />
  <variable entry="UI:TEMP:TRADE_ITEM:PRICE"
            type="sint64"
            value="-1" />
  <variable entry="UI:TEMP:TRADE_ITEM:PRICE_WITH_FAME"
            type="sint64"
            value="-1" />
  <variable entry="UI:TEMP:TRADE_ITEM:PRICE_RESALE"
            type="sint64"
            value="-1" />
  <variable entry="UI:TEMP:TRADE_ITEM:EDIT_QUANTITY"
            type="sint64"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:IS_SELL_DLG"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:DESTROY_QUANTITY"
            type="sint64"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:UNIT_PRICE_FACTION"
            type="sint64"
            value="-1" />
  <variable entry="UI:TEMP:TRADE_ITEM:PRICE_FACTION"
            type="sint64"
            value="-1" />
  <!-- db entry for the temporary sheet, in the window to buy / sell an item -->
  <variable entry="UI:TEMP:TRADE_ITEM:SHEET"
            type="sint64"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:QUALITY"
            type="sint64"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:QUANTITY"
            type="sint64"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:SLOT_TYPE"
            type="sint64"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:USER_COLOR"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:WEIGHT"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:NAMEID"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:INFO_VERSION"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:ENCHANT"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:RM_CLASS_TYPE"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:RM_FABER_STAT_TYPE"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:PREREQUISIT_VALID"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:TRADE_ITEM:BRICKS:$i:SHEET"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:MP_ITEM_PART_CHOICE"
            type="sint32"
            value="0" />
  <!-- List of items a Buildings can extract -->
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:SHEET"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:QUALITY"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:QUANTITY"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:SLOT_TYPE"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:USER_COLOR"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:NAMEID"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:INFO_VERSION"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:ENCHANT"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:RM_CLASS_TYPE"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:RM_FABER_STAT_TYPE"
            type="sint32"
            value="0"
            size="64" />
  <variable entry="UI:TEMP:TRADE_ITEM:BUILD_ITEMS:$i:PREREQUISIT_VALID"
            type="sint32"
            value="0"
            size="64" />
  <!-- skill points according to the selected botchat -->
  <variable entry="UI:TEMP:SP"
            type="sint32"
            value="0" />
  <!-- change the text and the value according to type -->
  <template name="skill_points_copy"
            id="">
    <link expr="switch(@SERVER:BOTCHAT:ROLEMASTER_TYPE, @%skill_points_0, @%skill_points_1, @%skill_points_2, @%skill_points_3)"
          action="set"
          params="dblink=UI:TEMP:SP|value=switch(@SERVER:BOTCHAT:ROLEMASTER_TYPE, @%skill_points_0, @%skill_points_1, @%skill_points_2, @%skill_points_3)" />
    <link expr="switch(@SERVER:BOTCHAT:ROLEMASTER_TYPE, 'uiSkillPoints0', 'uiSkillPoints1', 'uiSkillPoints2', 'uiSkillPoints3')"
          target="sp:sp_text:hardtext" />
  </template>
  <!-- Enable/disable resale -->
  <!--
        <proc id="click_resale_button" >
                <action handler="set" params="dblink=UI:TEMP:TRADE_ITEM:ENABLE_RESALE|value=not(@@UI:TEMP:TRADE_ITEM:ENABLE_RESALE)" />
                <action handler="set_focus_margin" />
        </proc>
        <template name="resale_button" id="" posparent="parent" posref="TL TL" x="0" y="0" sizeref="w" w="0" h="14" text="" >
                <group id="#id" sizeref="w" w="0" h="20" x="#x" y="#y" posref="#posref" posparent="#posparent">
                        <ctrl type="button" id="but" button_type="toggle_button" x="8" y="0" posref="ML ML"
                                                                                        tx_normal="W_slot_on.tga" tx_pushed="W_opacity_on.tga"
                                                                                        global_color_normal="false" global_color_over="false" global_color_pushed="false"
                                                                                        click_when_pushed="true" onclick_l="proc" params_l="click_resale_button" />

                        <view type="text" id="text" posparent="but" posref="MR ML" x="4" y="-3" fontsize="11" global_color="true" shadow="true" hardtext="#text" />

                        <link expr="@UI:TEMP:TRADE_ITEM:ENABLE_RESALE" target="but:pushed" />
                </group>
        </template>
-->
  <!-- modal box to confirm destruction of the item -->
  <group type="modal"
         id="bot_chat_destroy_confirm_modal"
         exit_click_out="true"
         posref="TL TL"
         x="-8"
         y="8"
         w="104"
         h="96"
         on_enter="botchat_confirm_destroy"
         options="skin_modal">
    <view type="bitmap"
          id="warning"
          posref="TL TL"
          x="4"
          y="-4"
          global_color="false"
          texture="w_warning_2.tga" />
    <view type="text"
          id="destroy_text"
          posref="TL TL"
          x="20"
          y="-5"
          color="233 197 42 255"
          fontsize="12"
          shadow="true"
          global_color="false"
          hardtext="uimDestroy" />
    <ctrl type="sheet"
          id="sheet"
          value="UI:TEMP:TRADE_ITEM"
          posparent="parent"
          posref="MM MM"
          y="0"
          x="0"
          use_quantity="false" />
    <view type="text"
          id="disp_number"
          posref="MR MM"
          posparent="sheet"
          x="16"
          y="-1"
          color="255 255 255 255"
          fontsize="12"
          shadow="true"
          global_color="false"
          hardtext="" />
    <!-- link to display the right number of item -->
    <link expr="str('x', @UI:TEMP:TRADE_ITEM:DESTROY_QUANTITY)"
          target="disp_number:hardtext" />
    <instance template="button_ok_cancel"
              posref="BR BR"
              x="-4"
              y="4"
              onclick_ok="botchat_confirm_destroy"
              onclick_cancel="leave_modal" />
  </group>
  <proc id="active_cosmetic_buy_desc">
    <action handler="set"
            params="target_property=ui:interface:bot_chat_buy_sell_item:header_opened:scroll_text:text_list:char3d:scene:char:anim|value=0" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_buy_sell_item:header_opened:scroll_text:text_list:char3d:scene:camface:posz|value=add(0.1,getprop('ui:interface:bot_chat_buy_sell_item:header_opened:scroll_text:text_list:char3d:scene:char:headz'))" />
    <action handler="set"
            params="target_property=ui:interface:bot_chat_buy_sell_item:header_opened:scroll_text:text_list:char3d:scene:camface:tgtz|value=add(0.16,getprop('ui:interface:bot_chat_buy_sell_item:header_opened:scroll_text:text_list:char3d:scene:char:headz'))" />
  </proc>
  <!-- special argent with fame influence -->
  <template name="argent_fame"
            posparent="parent"
            x="0"
            y="0"
            w="110"
            h="16"
            posref="TL TL"
            id=""
            value=""
            value_fame="">
    <group id="#id"
           posparent="#posparent"
           posref="#posref"
           w="#w"
           h="#h"
           x="#x"
           y="#y">
      <view type="bitmap"
            id="icone"
            posref="TL TL"
            texture="money_seve.tga"
            global_color="false" />
      <instance template="box_widget"
                id="box1"
                posref="TL TL"
                sizeref="w"
                w="-18"
                h="16"
                x="18" />
      <view type="text"
            id="val1"
            posparent="box1"
            posref="MR MR"
            x="-3"
            y="-2"
            color="135 243 28 255"
            shadow="true"
            fontsize="10"
            hardtext=""
            global_color="false" />
      <ctrl type="tooltip"
            id="tt"
            instant_help="true"
            posref="TL TL"
            x="0"
            y="0"
            sizeref="wh"
            w="0"
            h="0" />
      <link expr="getPriceWithFame(@#value,@#value_fame)"
            target="val1:uc_hardtext" />
      <link expr="ifthenelse(eq(@UI:TEMP:TRADE_ITEM:IS_SELL_DLG,1),ifthenelse(eq(@#value,@#value_fame),localize('uittPriceWithFameEqual'),localize('uittPriceWithFameDiff')),'')"
            target="tt:tooltip" />
    </group>
  </template>
  <!-- special 'diff' argent -->
  <template name="argent_diff"
            posparent="parent"
            x="0"
            y="0"
            w="110"
            h="16"
            posref="TL TL"
            id=""
            value_high=""
            value_low="">
    <group id="#id"
           posparent="#posparent"
           posref="#posref"
           w="#w"
           h="#h"
           x="#x"
           y="#y">
      <view type="bitmap"
            id="icone"
            posref="TL TL"
            texture="money_seve.tga"
            global_color="false" />
      <instance template="box_widget"
                id="box1"
                posref="TL TL"
                sizeref="w"
                w="-18"
                h="16"
                x="18" />
      <view type="text"
            id="val1"
            posparent="box1"
            posref="MR MR"
            x="-3"
            y="-2"
            color="135 243 28 255"
            shadow="true"
            fontsize="10"
            hardtext=""
            global_color="false" />
      <link expr="getBonusOnResale(@#value_high,@#value_low)"
            target="val1:uc_hardtext" />
    </group>
  </template>
  <!-- the modal -->
  <group id="bot_chat_buy_sell_item"
         type="container"
         posref="BL TL"
         min_w="408"
         max_w="408"
         w="408"
         x="332"
         y="200"
         pop_max_h="700"
         max_h="2000"
         active="false"
         openable="false"
         opened="true"
         movable="true"
         resizer="false"
         savable="false"
         title="uiBotChatMissions"
         escapable="true"
         header_color="UI:SAVE:WIN:COLORS:BOT"
         global_color="false"
         on_deactive="cancel_trade"
         on_enter="confirm_trade"
         on_enter_params="resale=2"
         on_active="proc"
         on_active_params="active_cosmetic_buy_desc">
    <!-- on_enter_params=2: means 0 if Shift+Enter, 1 if Enter -->
    <group id="header_opened"
           child_resize_h="true"
           child_resize_hmargin="20"
           w="0"
           x="0"
           y="0"
           posref="TL TL">
      <!-- SLOT -->
      <!-- NB: use_quantity is forced with copyAspect(), and decide its cool to know max quantity we own -->
      <ctrl type="sheet"
            id="buy_sell_slot"
            nature="auto"
            dragable="false"
            posref="TL TL"
            x="8"
            y="-20"
            value="UI:TEMP:TRADE_ITEM"
            onclick_r="open_help_auto"
            use_slot_type_db_entry="true" />
      <!-- //STANDARD PRICE. -->
      <group id="standard_price"
             posref="TL TL"
             x="0"
             y="-32"
             sizeref="w"
             child_resize_h="true">
        <!-- //UNIT VALUE -->
        <view type="text"
              id="unit_price_header"
              posref="TL TL"
              color="255 255 255 255"
              fontsize="10"
              x="64"
              y="0"
              shadow="true"
              hardtext="uiUnitValue" />
        <group id="unit_price"
               posparent="unit_price_header"
               posref="BL TL"
               x="0"
               y="-2"
               child_resize_w="true"
               child_resize_h="true">
          <instance template="argent_fame"
                    id="item_price"
                    posref="ML ML"
                    x="0"
                    w="130"
                    h="16"
                    value="UI:TEMP:TRADE_ITEM:UNIT_PRICE"
                    value_fame="UI:TEMP:TRADE_ITEM:UNIT_PRICE_WITH_FAME" />
        </group>
        <!-- //QUANTITY EDIT BOX -->
        <view type="text"
              id="quantity_header"
              posref="TL TL"
              color="255 255 255 255"
              fontsize="10"
              x="202"
              y="0"
              shadow="true"
              hardtext="uiQtty" />
        <group id="quantity"
               posparent="quantity_header"
               posref="BL TL"
               x="0"
               y="1"
               w="42"
               child_resize_h="true">
          <view type="text"
                id="cross"
                posref="ML ML"
                color="255 255 255 255"
                fontsize="10"
                x="1"
                y="-3"
                shadow="true"
                hardtext="X" />
          <instance template="edit_box_widget"
                    id="edit"
                    posref="MR MR"
                    x="-6"
                    text_x="0"
                    text_ref="BR BR"
                    w="26"
                    prompt=""
                    enter_loose_focus="true"
                    multi_line="false"
                    max_num_chars="3"
                    onenter="confirm_trade"
                    params="resale=2"
                    enter_recover_focus="false"
                    reset_focus_on_hide="true"
                    max_historic="0"
                    entry_type="positive_integer" />
        </group>
        <!-- //IMMEDIATE PRICE or SKILL POINTS (only one displayed at the same time) -->
        <view type="text"
              id="total_price_header"
              posref="TR TR"
              color="255 255 255 255"
              fontsize="10"
              x="-12"
              y="0"
              shadow="true"
              hardtext="uiImmediatePrice" />
        <group id="total_price"
               posparent="total_price_header"
               posref="BR TR"
               x="0"
               y="0"
               child_resize_w="true"
               child_resize_h="true">
          <view type="text"
                id="equal"
                posref="ML ML"
                color="255 255 255 255"
                y="-3"
                fontsize="16"
                shadow="true"
                hardtext="=" />
          <instance template="argent_fame"
                    id="item_price"
                    posref="ML ML"
                    x="12"
                    w="130"
                    h="16"
                    value="UI:TEMP:TRADE_ITEM:PRICE"
                    value_fame="UI:TEMP:TRADE_ITEM:PRICE_WITH_FAME" />
          <instance template="skill_points_widget2"
                    value="UI:TEMP:TRADE_ITEM:PRICE"
                    id="sp"
                    y="-3"
                    posref="ML ML" />
        </group>
      </group>
      <!-- //FACTION POINT PRICE. NB: cannot have both Faction Point Price and Resell Price -->
      <group id="faction_price"
             posref="TL TL"
             x="0"
             y="-32"
             sizeref="w"
             child_resize_h="true">
        <!-- //FACTION PRICE -->
        <view type="text"
              id="unit_price_header"
              posref="TL TL"
              color="255 255 255 255"
              fontsize="10"
              x="64"
              y="0"
              shadow="true"
              hardtext="uiUnitFPPrice" />
        <group id="unit_price"
               posparent="unit_price_header"
               posref="BL TL"
               x="0"
               y="-2"
               child_resize_w="true"
               child_resize_h="true">
          <instance template="argent"
                    id="item_price"
                    posref="ML ML"
                    x="0"
                    w="130"
                    h="16"
                    value="UI:TEMP:TRADE_ITEM:UNIT_PRICE_FACTION" />
        </group>
        <!-- //QUANTITY (not editable, can be hidden) -->
        <view type="text"
              id="quantity_header"
              posref="TL TL"
              color="255 255 255 255"
              fontsize="10"
              x="202"
              y="0"
              shadow="true"
              hardtext="" />
        <group id="quantity"
               posparent="quantity_header"
               posref="BL TL"
               x="0"
               y="-3"
               w="42"
               child_resize_h="true">
          <view type="text"
                id="cross"
                posref="ML ML"
                color="255 255 255 255"
                fontsize="10"
                x="1"
                y="-2"
                shadow="true"
                hardtext="X" />
          <view type="text_number"
                id="val"
                active="false"
				posref="MR MR"
                color="255 255 255 255"
                fontsize="10"
                x="-12"
                y="-2"
                shadow="true"
                value="UI:TEMP:TRADE_ITEM:EDIT_QUANTITY"
                global_color="false"
                positive="true" />
        </group>
        <!-- //TOTAL FACTION PRICE -->
        <view type="text"
              id="total_price_header"
              posref="TR TR"
              color="255 255 255 255"
              fontsize="10"
              x="-12"
              y="0"
              shadow="true"
              hardtext="uiResaleHeader" />
        <group id="total_price"
               posparent="total_price_header"
               posref="BR TR"
               x="0"
               y="0"
               child_resize_w="true"
               child_resize_h="true">
          <view type="text"
                id="equal"
                posref="ML ML"
                color="255 255 255 255"
                y="-3"
                fontsize="16"
                shadow="true"
                hardtext="=" />
          <instance template="argent"
                    id="item_price"
                    posref="ML ML"
                    x="12"
                    w="130"
                    h="16"
                    value="UI:TEMP:TRADE_ITEM:PRICE_FACTION" />
        </group>
      </group>
      <!-- //RESELL PRICE (item sell only) -->
      <group id="resell_group"
             posref="TL TL"
             x="0"
             y="-64"
             sizeparent="parent"
             sizeref="w"
             child_resize_h="true">
        <!-- RESELL group -->
        <group id="can_resell"
               posref="TL TL"
               x="0"
               y="0"
               sizeref="w"
               child_resize_h="true">
          <!-- choose resale -->
          <group id="choose_resell"
                 posref="TL TL"
                 x="0"
                 y="0"
                 sizeref="w"
                 child_resize_h="true">
            <!-- Title -->
            <!-- //RESALE MARGIN EDIT BOX -->
            <view type="text"
                  id="header"
                  posref="TL TL"
                  color="255 255 255 255"
                  fontsize="10"
                  x="64"
                  y="0"
                  shadow="true"
                  hardtext="uiResaleMargin" />
            <ctrl type="button"
                  id="arrow_up"
                  button_type="push_button"
                  posparent="header"
                  x="6"
                  posref="BL TL"
                  tx_normal="W_arrow_up_1.tga"
                  tx_pushed="W_arrow_up_1.tga"
                  tx_over="W_button_12_over.tga"
                  onclick_l="change_resale_margin"
                  params_l="5"
                  onclick_r="change_resale_margin"
                  params_r="20" />
            <ctrl type="button"
                  id="arrow_down"
                  button_type="push_button"
                  posparent="arrow_up"
                  posref="BL TL"
                  tx_normal="W_arrow_down_1.tga"
                  tx_pushed="W_arrow_down_1.tga"
                  tx_over="W_button_12_over.tga"
                  onclick_l="change_resale_margin"
                  params_l="-5"
                  onclick_r="change_resale_margin"
                  params_r="-20" />
            <instance template="edit_box_widget"
                      id="edit"
                      posparent="arrow_down"
                      posref="TR ML"
                      text_x="0"
                      text_ref="BR BR"
                      w="42"
                      prompt="+"
                      enter_loose_focus="true"
                      multi_line="false"
                      onenter="confirm_trade"
                      params="resale=2"
                      enter_recover_focus="false"
                      reset_focus_on_hide="true"
                      max_historic="0"
                      entry_type="positive_integer"
                      max_num_chars="5" />
            <view type="text"
                  id="pct"
                  posparent="edit"
                  posref="MR ML"
                  color="255 255 255 255"
                  fontsize="10"
                  x="0"
                  y="0"
                  shadow="true"
                  hardtext="%%" />
            <!-- //BONUS ON RESALE-->
            <view type="text"
                  id="bonus_header"
                  posref="TR TR"
                  color="255 255 255 255"
                  fontsize="10"
                  x="-12"
                  y="0"
                  shadow="true"
                  hardtext="uiBonusOnResale" />
            <group id="bonus_on_resale"
                   posparent="bonus_header"
                   posref="BR TR"
                   x="0"
                   y="-2"
                   child_resize_w="true"
                   child_resize_h="true">
              <instance template="argent_diff"
                        id="bonus"
                        posref="ML ML"
                        x="0"
                        w="130"
                        h="16"
                        value_high="UI:TEMP:TRADE_ITEM:PRICE_RESALE"
                        value_low="UI:TEMP:TRADE_ITEM:PRICE_WITH_FAME" />
            </group>
            <!-- //UNIT RESALE PRICE-->
            <view type="text"
                  id="unit_price_header"
                  posref="TL TL"
                  color="255 255 255 255"
                  fontsize="10"
                  x="64"
                  y="-43"
                  shadow="true"
                  hardtext="uiUnitResalePrice" />
            <group id="unit_price"
                   posparent="unit_price_header"
                   posref="BL TL"
                   x="0"
                   y="-2"
                   child_resize_w="true"
                   child_resize_h="true">
              <instance template="argent"
                        id="item_price"
                        posref="ML ML"
                        x="0"
                        w="130"
                        h="16"
                        value="UI:TEMP:TRADE_ITEM:UNIT_PRICE_RESALE" />
            </group>
            <!-- //QUANTITY (not editable, can be hidden) -->
            <view type="text"
                  id="quantity_header"
                  posref="TL TL"
                  color="255 255 255 255"
                  fontsize="10"
                  x="202"
                  y="-43"
                  shadow="true"
                  hardtext="" />
            <group id="quantity"
                   posparent="quantity_header"
                   posref="BL TL"
                   x="0"
                   y="-3"
                   w="42"
                   child_resize_h="true">
              <view type="text"
                    id="cross"
                    posref="ML ML"
                    color="255 255 255 255"
                    fontsize="10"
                    x="1"
                    y="-2"
                    shadow="true"
                    hardtext="X" />
              <view type="text_number"
                    id="val"
                    posref="MR MR"
                    color="255 255 255 255"
                    fontsize="10"
                    x="-12"
                    y="-2"
                    shadow="true"
                    value="UI:TEMP:TRADE_ITEM:EDIT_QUANTITY"
                    global_color="false"
                    positive="true" />
            </group>
            <!-- //RESALE PRICE -->
            <view type="text"
                  id="total_price_header"
                  posref="TR TR"
                  color="255 255 255 255"
                  fontsize="10"
                  x="-12"
                  y="-43"
                  shadow="true"
                  hardtext="uiResaleHeader" />
            <group id="total_price"
                   posparent="total_price_header"
                   posref="BR TR"
                   x="0"
                   y="0"
                   child_resize_w="true"
                   child_resize_h="true">
              <view type="text"
                    id="equal"
                    posref="ML ML"
                    color="255 255 255 255"
                    y="-3"
                    fontsize="16"
                    shadow="true"
                    hardtext="=" />
              <instance template="argent"
                        id="item_price"
                        posref="ML ML"
                        x="12"
                        w="130"
                        h="16"
                        value="UI:TEMP:TRADE_ITEM:PRICE_RESALE" />
            </group>
          </group>
        </group>
        <!-- CAN'T RESELL group -->
        <group id="cant_resell"
               posref="TL TL"
               x="0"
               y="0"
               sizeref="w"
               h="35">
          <view type="bitmap"
                id="warning"
                posref="ML ML"
                x="0"
                y="0"
                texture="W_warning.tga"
                global_color="false" />
          <view type="text"
                id="reason"
                posparent="warning"
                posref="MR ML"
                x="2"
                y="-3"
                color="255 255 255 255"
                fontsize="10"
                shadow="true"
                hardtext=""
                multi_line="true"
                multi_line_space="0" />
        </group>
      </group>
      <!-- description of item -->
      <group id="scroll_text"
             sizeref="w"
             posparent="resell_group"
             posref="BL TL"
             w="0"
             y="-2"
             child_resize_h="true"
             child_resize_hmargin="8">
        <instance template="inner_thin_border_group" />
        <group id="text_list"
               posref="TL TL"
               x="16"
               y="-4"
               sizeref="w"
               w="-16"
               child_resize_h="true"
               max_h="392"
               space="0">
          <view type="text"
                id="help_text"
                multi_line="true"
                multi_line_space="0"
                posref="TL TL" />
          <!-- for item, pacts, .. -->
          <!-- For Phrases only. list only the bricks for phrases -->
          <view type="text"
                id="list_brick_header"
                multi_line="true"
                multi_line_space="0"
                posparent="help_text"
                posref="BL TL"
                y="-12" />
          <!-- must set force_keep=-1, to avoid any "forceKeep" window -->
          <instance template="template_info_list_brick"
                    type="list_sheet_compo_brick"
                    id="list_brick"
                    force_keep="-1"
                    brickdb="UI:TEMP:TRADE_ITEM:BRICKS"
                    posparent="list_brick_header"
                    param_deltax="13"
                    auto_grayed="false" />
          <!-- For raw materials only. group to display stats -->
          <instance template="template_info_mp_stats"
                    posparent="help_text"
                    dbcombo="UI:TEMP:TRADE_ITEM:MP_ITEM_PART_CHOICE"
                    cb_handler="item_botchat_mp_change_item_part"
                    cb_params="wnd=ui:interface:bot_chat_buy_sell_item|dbitem=UI:TEMP:TRADE_ITEM:SHEET|prefix=:header_opened:scroll_text:text_list:" />
          <!-- For outpost building, list of items this building build -->
          <instance template="template_info_list_item"
                    type="list_sheet_text"
                    id="list_item"
                    force_keep="-1"
                    itemdb="UI:TEMP:TRADE_ITEM:BUILD_ITEMS"
                    posparent="help_text" />
          <!-- For Cosmetic only 3D preview -->
          <group id="char3d"
                 posref="TL TL"
                 sizeref="w"
                 w="-16"
                 h="304"
                 x="0"
                 y="-46">
            <instance template="box_widget"
                      id="back"
                      posref="TL TL"
                      sizeref="wh"
                      w="0"
                      h="0"
                      x="0"
                      y="0"
                      inherit_gc_alpha="true" />
            <view type="bitmap"
                  id="black"
                  posparent="back"
                  posref="MM MM"
                  sizeref="wh"
                  w="-2"
                  h="-2"
                  inherit_gc_alpha="true"
                  scale="true"
                  texture="blank.tga"
                  color="0 0 0 80" />
            <scene3d id="scene"
                     sizeref="wh"
                     w="-2"
                     h="-2"
                     posparent="back"
                     posref="TL TL"
                     x="1"
                     y="-1"
                     curcam="camface"
                     curcs="env"
                     render_layer="-2"
                     user_interaction="true"
                     rotz_factor="0.017"
                     roty_factor="0.005"
                     roty_limit_min="-20"
                     roty_limit_max="15"
                     dist_factor="0.005"
                     dist_limit_min="3.0"
                     dist_limit_max="7.0"
                     ambient="128 96 64"
                     sun_ambient="0 0 0"
                     sun_diffuse="255 255 196"
                     sun_specular="0 0 0"
                     sun_direction="-1.0 1.0 -1.0">
              <character3d id="char"
                           dblink="UI:TEMP:CHAR3D"
                           pos="0.0 0.0 -1.75"
                           rot="0.0 0.0 0.0" />
              <camera id="camface"
                      fov="5"
                      pos="0.0 -5.0 0.0"
                      target="0.0 0.0 0"
                      roll="0" />
              <light id="back"
                     pos="0.0 28.2 1.6"
                     color="96 64 32"
                     near="1.0"
                     far="4.0" />
              <light id="lgt"
                     pos="0.0 25.3 2.48"
                     color="255 255 255"
                     near="1.0"
                     far="4.0" />
            </scene3d>
          </group>
        </group>
        <ctrl style="skin_scroll"
              id="sv"
              posref="TL TL"
              x="4"
              y="-4"
              target="text_list"
              target_stepy="14" />
      </group>
      <!-- // VALIDATION GROUP WITH THE MATCHING TEXT -->
      <group id="confirm_trade"
             posref="BR TR"
             x="0"
             y="-4"
             posparent="scroll_text"
             child_resize_w="true"
             child_resize_h="true">
        <!-- <view type="bitmap" id="bg" sizeref="hw" color="255 0 0 255" posref="TL TL" scale="true" texture="W_modal_BLANK.tga"/> -->
        <group id="place_holder"
               posref="TR TR"
               x="0"
               y="0"
               w="16"
               h="16" />
        <instance template="button_ok_cancel"
                  posref="TR TR"
                  x="0"
                  y="0"
                  onclick_ok="confirm_trade"
                  onclick_ok_param="resale=0"
                  onclick_cancel="set"
                  onclick_cancel_param="target_property=ui:interface:bot_chat_buy_sell_item:active|value=0" />
      </group>
      <!-- // RESELL BUTTON -->
      <ctrl id="confirm_trade_resell"
            style="button_ok"
            tooltip="uittResellButton"
            x="-4"
            y="0"
            posparent="confirm_trade"
            posref="ML MR"
            text_y="-2"
            onclick_l="confirm_trade"
            params_l="resale=1"
            hardtext="uiLetResell" />
      <!-- group to say that player can't buy item -->
      <group id="cant_trade"
             posref="BR TR"
             x="0"
             y="-4"
             posparent="scroll_text"
             child_resize_w="true"
             child_resize_h="true">
        <!-- <view type="bitmap" id="bg" sizeref="hw" color="255 0 0 255" posref="TL TL" scale="true" texture="W_modal_BLANK.tga"/> -->
        <group id="place_holder"
               posref="TR TR"
               x="0"
               y="0"
               w="16"
               h="16" />
        <ctrl style="text_button_16"
              id="cant_trade_button"
              posref="TR TR"
              x="0"
              y="0"
              button_type="push_button"
              onclick_l="set"
              params_l="target_property=ui:interface:bot_chat_buy_sell_item:active|value=0"
              hardtext="uittCancel" />
      </group>
      <!-- group to offer destroy of user item -->
      <group id="destroy_trade"
             posref="BL TL"
             x="0"
             y="-4"
             posparent="scroll_text"
             child_resize_w="true"
             child_resize_h="true">
        <group id="place_holder"
               posref="TL TL"
               x="0"
               y="0"
               w="16"
               h="16" />
        <ctrl style="text_button_16"
              id="destroy_trade_button"
              posref="TL TL"
              x="0"
              y="0"
              button_type="push_button"
              onclick_l="botchat_enter_destroy"
              hardtext="uiBCDestroy" />
      </group>
    </group>
  </group>
  <!-- ******************************************** -->
  <!-- *     BOT CHAT PAGE FOR TRADE : BUY & SELL * -->
  <!-- ******************************************** -->
  <define id="trade_slot_height"
          value="414" />
  <define id="trade_slot_back_h"
          value="420" />
  <variable entry="UI:VARIABLES:BOTCHAT:BUY_LIST_SELECTED"
            type="sint32"
            value="0" />
  <variable entry="UI:VARIABLES:BOTCHAT:TEMP_FILTER_MIN_CLASS"
            type="sint32"
            value="0" />
  <variable entry="UI:VARIABLES:BOTCHAT:TEMP_FILTER_MAX_CLASS"
            type="sint32"
            value="4" />
  <!-- view of the item type selected -->
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE:SHEET"
            type="sint32"
            value="0" />
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE:QUALITY"
            type="sint32"
            value="0" />
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE:QUANTITY"
            type="sint32"
            value="0" />
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE:USER_COLOR"
            type="sint32"
            value="1" />
  <!-- init beige by default -->
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE:WEIGHT"
            type="sint32"
            value="0" />
  <!-- selection of the item type -->
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED:$i:SHEET"
            type="sint32"
            value="0"
            size="128" />
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED:$i:QUALITY"
            type="sint32"
            value="0"
            size="128" />
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED:$i:QUANTITY"
            type="sint32"
            value="0"
            size="128" />
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED:$i:USER_COLOR"
            type="sint32"
            value="1"
            size="128" />
  <!-- init beige by default -->
  <variable entry="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED:$i:WEIGHT"
            type="sint32"
            value="0"
            size="128" />
  <!-- selection of the item type is automatically modified when the bitfield change -->
  <link expr="@SERVER:TRADING:ITEM_TYPE_SELLER_BITFILED_0_63"
        action="botchat_refill_item_type_choice_list"
        params="src=SERVER:TRADING:ITEM_TYPE_SELLER_BITFILED_0_63|dest=UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED|offset=0" />
  <link expr="@SERVER:TRADING:ITEM_TYPE_SELLER_BITFILED_64_127"
        action="botchat_refill_item_type_choice_list"
        params="src=SERVER:TRADING:ITEM_TYPE_SELLER_BITFILED_64_127|dest=UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED|offset=64" />
  <!-- Template for A Sell List -->
  <template name="temp_list_sell"
            id=""
            dbentry=""
            db_animal_status="">
    <!-- PLAYER NAME -->
    <!--
        <view type="text_formated" id="player_name" posref="TL TL" x="4" y="-8" color="255 255 255 255" fontsize="14" shadow="true" format="$p"/>
        -->
    <!-- LIST OF ITEMS TO SELL  -->
    <!-- The H should be "42+hspace" * Number of rows. Setup list.max_h too below-->
    <group type="list_sheet_trade"
           sizeref="w"
           x="2"
           y="0"
           w="0"
           h="%trade_slot_height"
           id="#id"
           posparent="parent"
           posref="TL TL"
           xitem="2"
           yitem="-2"
           xtext="46"
           ytext="-2"
           hspace="4"
           array="false"
           value="#dbentry"
           want_price="true"
           use_quantity="true"
           use_quality="true"
           dragable="false"
           use_slot_type_db_entry="false"
           nature="auto"
           onclick_l="sell_item"
           onclick_r="open_help_auto"
           over_color="%bot_chat_sheet_selection_normal"
           over_col_pushed="%bot_chat_sheet_selection_pushed"
           over_col_over="%bot_chat_sheet_selection_over"
           click_when_pushed="true"
           color="255 255 255 255"
           fontsize="8"
           shadow="true"
           multi_line="true"
           multi_line_space="0"
           multiply_price_by_quantity="true"
           db_animal_status="#db_animal_status"
           test_drop_or_sell="true"
           apply_fame_price_factor="true">
      <!-- the scroll -->
      <ctrl style="skin_scroll"
            id="scroll_row"
            posref="TL TL"
            x="2"
            target_stepy="46" />
      <!-- the group to scroll -->
      <group id="list"
             sizeref="w"
             posref="TL TL"
             max_h="%trade_slot_height"
             x="12"
             y="0"
             w="-12"
             h="0" />
    </group>
  </template>
  <!-- Template for A Buy List -->
  <template name="temp_list_buy"
            id=""
            use_quantity=""
            filter_seller_type="none">
    <!-- VENDOR NAME -->
    <!--
        <view type="text_formated" id="vendor_name" posref="TL TL" x="4" y="-8" color="255 255 255 255" fontsize="14" shadow="true" format="$b"/>
        -->
    <!-- LIST OF ITEMS TO BUY  -->
    <!-- The H should be "42+hspace" * Number of rows. Setup list.max_h too below-->
    <group type="list_sheet_trade"
           sizeref="w"
           w="0"
           x="2"
           y="0"
           h="%trade_slot_height"
           id="#id"
           posparent="parent"
           posref="TL TL"
           xitem="2"
           yitem="-2"
           xtext="46"
           ytext="-2"
           hspace="4"
           array="false"
           value="%trade"
           want_price="true"
           use_quantity="#use_quantity"
           use_quality="true"
           dragable="false"
           use_slot_type_db_entry="false"
           nature="auto"
           onclick_l="buy_item"
           onclick_r="open_help_auto"
           over_color="%bot_chat_sheet_selection_normal"
           over_col_pushed="%bot_chat_sheet_selection_pushed"
           over_col_over="%bot_chat_sheet_selection_over"
           click_when_pushed="true"
           color="255 255 255 255"
           fontsize="8"
           shadow="true"
           multi_line="true"
           multi_line_space="0"
           multiply_price_by_quantity="#use_quantity"
           filter_seller_type="#filter_seller_type">
      <!-- the scroll -->
      <ctrl style="skin_scroll"
            id="scroll_row"
            posref="TL TL"
            x="2"
            target_stepy="46" />
      <!-- the group to scroll -->
      <group id="list"
             sizeref="w"
             posref="TL TL"
             max_h="%trade_slot_height"
             x="12"
             y="0"
             w="-12"
             h="0" />
      <!-- notification message to signal an empty list -->
      <view type="text"
            id="empty_list_notify"
            hardtext="uiNoTrainingAvailable"
            color="255 255 255 255"
            global_color="false"
            posref="MM MM"
            fontsize="15"
            shadow="true"
            multi_line="true"
            line_maxw="415"
            multi_line_space="0"
            active="false" />
    </group>
  </template>
  <!-- BOTCHAT BUY FILTERING -->
  <!-- Dialog to select the Min and Max for filtering of Price or Quality -->
  <group type="modal"
         id="bot_chat_change_buy_filter"
         w="200"
         h="92"
         x="0"
         y="0"
         active="false"
         options="skin_modal"
         escapable="true"
         global_color="true"
         on_enter="confirm_change_botchat_buy_filter">
    <!-- Title -->
    <view type="text"
          id="title"
          posref="TL TL"
          x="6"
          y="-4"
          color="255 255 255 255"
          global_color="false"
          fontsize="14"
          shadow="true" />
    <!-- Min selection -->
    <view type="text"
          id="text_min"
          posparent="title"
          posref="BL TL"
          x="0"
          y="-4"
          global_color="false"
          fontsize="10"
          shadow="true"
          hardtext="uiBCFilterMin" />
    <instance template="edit_box_widget"
              id="edit_min"
              posparent="text_min"
              posref="ML ML"
              x="50"
              text_x="-4"
              text_ref="BR BR"
              w="120"
              prompt=""
              enter_loose_focus="true"
              multi_line="false"
              onenter="change_botchat_buy_filter_give_focus_to_max"
              enter_recover_focus="false"
              reset_focus_on_hide="true"
              max_historic="0"
              entry_type="positive_integer" />
    <!-- Max selection -->
    <view type="text"
          id="text_max"
          posparent="text_min"
          posref="BL TL"
          x="0"
          y="-12"
          global_color="false"
          fontsize="10"
          shadow="true"
          hardtext="uiBCFilterMax" />
    <instance template="edit_box_widget"
              id="edit_max"
              posparent="text_max"
              posref="ML ML"
              x="50"
              text_x="-4"
              text_ref="BR BR"
              w="120"
              prompt=""
              enter_loose_focus="true"
              multi_line="false"
              onenter="confirm_change_botchat_buy_filter"
              enter_recover_focus="false"
              reset_focus_on_hide="true"
              max_historic="0"
              entry_type="positive_integer" />
    <!-- OK/Cancel -->
    <instance template="button_ok_cancel"
              posref="BR BR"
              x="-6"
              y="6"
              onclick_ok="confirm_change_botchat_buy_filter"
              onclick_cancel="set"
              onclick_cancel_param="target_property=ui:interface:bot_chat_change_buy_filter:active|value=0" />
    <!-- Reset button -->
    <ctrl style="text_button_16"
          posref="BL BL"
          x="6"
          y="6"
          id="reset"
          onclick_l="reset_botchat_buy_filter"
          hardtext="uiBCFilterReset" />
  </group>
  <!-- group for a Numbered filter -->
  <template name="botchat_buy_filter"
            id=""
            posparent=""
            posref=""
            x=""
            y=""
            w=""
            h=""
            text=""
            dialog_title=""
            dbext=""
            maxvalue="">
    <group id="#id"
           posparent="#posparent"
           posref="#posref"
           x="#x"
           y="#y"
           h="#h"
           child_resize_w="true"
           child_resize_wmargin="8">
      <ctrl style="text_button_16"
            id="ctrl"
            posref="ML ML"
            hardtext="#text"
            x="4"
            onclick_l="enter_change_botchat_buy_filter"
            params_l="dbext=#dbext|title=#dialog_title|maxvalue=#maxvalue" />
      <view type="text"
            id="text"
            posparent="ctrl"
            posref="MR ML"
            fontsize="10"
            x="2"
            y="-1" />
      <link expr="getBotChatBuyFilter(@UI:SAVE:BOTCHAT_FILTER:MIN_#dbext,@UI:SAVE:BOTCHAT_FILTER:MAX_#dbext)"
            target="text:hardtext" />
    </group>
  </template>
  <!-- ctrl for a MP itemPart filtering -->
  <template name="ctrl_botchat_buy_mp_filter_base"
            id=""
            posparent=""
            posref="TR TL"
            x="2"
            y="0"
            ft=""
            ico=""
            tooltip="">
    <ctrl type="button"
          id="#id"
          posparent="#posparent"
          posref="#posref"
          button_type="push_button"
          x="#x"
          y="#y"
          onclick_l="confirm_change_botchat_buy_filter_mp"
          params_l="#ft"
          tx_normal="#ico"
          tx_pushed="#ico"
          tx_over="blank.tga"
          scale="true"
          w="24"
          h="24"
          tooltip_i18n="#tooltip"
          col_over="255 255 255 128"
          global_color="false" />
    <view type="bitmap"
          id="back_#id"
          posparent="#id"
          posref="TL TL"
          global_color="false"
          x="-1"
          y="1"
          texture="W_slot_spell.tga"
          scale="true"
          w="26"
          h="26" />
  </template>
  <!-- ctrl for a MP itemPart filtering. tooltip deduced from ft -->
  <template name="ctrl_botchat_buy_mp_filter"
            id=""
            posparent=""
            posref="TR TL"
            x="2"
            y="0"
            ft=""
            ico="">
    <instance template="ctrl_botchat_buy_mp_filter_base"
              id="#id"
              posparent="#posparent"
              posref="#posref"
              x="#x"
              y="#y"
              ft="#ft"
              ico="#ico"
              tooltip="mpft#ft" />
  </template>
  <!-- Dialog to select the MP ItemPart -->
  <group type="modal"
         id="bot_chat_change_buy_filter_mp"
         w="190"
         h="132"
         x="0"
         y="0"
         active="false"
         options="skin_modal"
         escapable="true"
         global_color="true">
    <!-- Title -->
    <view type="text"
          id="title"
          posref="TL TL"
          x="6"
          y="-4"
          color="255 255 255 255"
          global_color="false"
          fontsize="14"
          shadow="true"
          hardtext="uiBCTitleMPItemPart" />
    <!-- 1st Line -->
    <!-- First is the 'no filter' button => special tooltip, and empty 'ft' filter -->
    <instance template="ctrl_botchat_buy_mp_filter_base"
              id="ct00"
              posparent="parent"
              posref="TL TL"
              x="6"
              y="-32"
              ft=""
              ico="%item_part_icon_"
              tooltip="uittBCNoItemPartFilter" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct01"
              posparent="ct00"
              ft="MpL"
              ico="%item_part_icon_MpL" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct02"
              posparent="ct01"
              ft="MpH"
              ico="%item_part_icon_MpH" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct03"
              posparent="ct02"
              ft="MpP"
              ico="%item_part_icon_MpP" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct04"
              posparent="ct03"
              ft="MpM"
              ico="%item_part_icon_MpM" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct05"
              posparent="ct04"
              ft="MpG"
              ico="%item_part_icon_MpG" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct06"
              posparent="ct05"
              ft="MpC"
              ico="%item_part_icon_MpC" />
    <!-- 2nd Line -->
    <!-- Organized so Magic Focus follow Melee weapon, and rest of line is RangeWeapon + Ammo -->
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct10"
              posparent="ct00"
              posref="BL TL"
              x="0"
              y="-2"
              ft="MpMF"
              ico="%item_part_icon_MpMF" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct11"
              posparent="ct10"
              ft="MpGA"
              ico="%item_part_icon_MpGA" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct12"
              posparent="ct11"
              ft="MpPE"
              ico="%item_part_icon_MpPE" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct13"
              posparent="ct12"
              ft="MpCA"
              ico="%item_part_icon_MpCA" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct14"
              posparent="ct13"
              ft="MpE"
              ico="%item_part_icon_MpE" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct15"
              posparent="ct14"
              ft="MpEN"
              ico="%item_part_icon_MpEN" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct16"
              posparent="ct15"
              ft="MpPR"
              ico="%item_part_icon_MpPR" />
    <!-- 3rd Line -->
    <!-- Organized so Armor/Clothes together, then jewel -->
    <!-- NB: 18 - 23 Item parts are not still valids -->
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct20"
              posparent="ct10"
              posref="BL TL"
              x="0"
              y="-2"
              ft="MpVE"
              ico="%item_part_icon_MpVE" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct21"
              posparent="ct20"
              ft="MpCR"
              ico="%item_part_icon_MpCR" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct22"
              posparent="ct21"
              ft="MpRI"
              ico="%item_part_icon_MpRI" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct23"
              posparent="ct22"
              ft="MpRE"
              ico="%item_part_icon_MpRE" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct24"
              posparent="ct23"
              ft="MpAT"
              ico="%item_part_icon_MpAT" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct25"
              posparent="ct24"
              ft="MpSU"
              ico="%item_part_icon_MpSU" />
    <instance template="ctrl_botchat_buy_mp_filter"
              id="ct26"
              posparent="ct25"
              ft="MpED"
              ico="%item_part_icon_MpED" />
  </group>
  <!-- Dialog to select the Min and Max for filtering of Class -->
  <group type="modal"
         id="bot_chat_change_buy_filter_class"
         w="200"
         h="92"
         x="0"
         y="0"
         active="false"
         options="skin_modal"
         escapable="true"
         global_color="true"
         on_enter="confirm_change_botchat_buy_filter_class">
    <!-- Title -->
    <view type="text"
          id="title"
          posref="TL TL"
          x="6"
          y="-4"
          color="255 255 255 255"
          global_color="false"
          fontsize="14"
          shadow="true"
          hardtext="uiBCTitleFilterClass" />
    <!-- Min selection -->
    <view type="text"
          id="text_min"
          posparent="title"
          posref="BL TL"
          x="0"
          y="-4"
          global_color="false"
          fontsize="10"
          shadow="true"
          hardtext="uiBCFilterMin" />
    <group type="combo_box"
           id="combo_min"
           posparent="text_min"
           posref="ML ML"
           x="50"
           y="0"
           w="120"
           h="20"
           value="UI:VARIABLES:BOTCHAT:TEMP_FILTER_MIN_CLASS">
      <instance template="combo_box_def1" />
      <combo_text name="uiBCFilterClass0" />
      <combo_text name="uiBCFilterClass1" />
      <combo_text name="uiBCFilterClass2" />
      <combo_text name="uiBCFilterClass3" />
      <combo_text name="uiBCFilterClass4" />
    </group>
    <!-- Max selection -->
    <view type="text"
          id="text_max"
          posparent="text_min"
          posref="BL TL"
          x="0"
          y="-12"
          global_color="false"
          fontsize="10"
          shadow="true"
          hardtext="uiBCFilterMax" />
    <group type="combo_box"
           id="combo_max"
           posparent="text_max"
           posref="ML ML"
           x="50"
           y="0"
           w="120"
           h="20"
           value="UI:VARIABLES:BOTCHAT:TEMP_FILTER_MAX_CLASS">
      <instance template="combo_box_def1" />
      <combo_text name="uiBCFilterClass0" />
      <combo_text name="uiBCFilterClass1" />
      <combo_text name="uiBCFilterClass2" />
      <combo_text name="uiBCFilterClass3" />
      <combo_text name="uiBCFilterClass4" />
    </group>
    <!-- OK/Cancel -->
    <instance template="button_ok_cancel"
              posref="BR BR"
              x="-6"
              y="6"
              onclick_ok="confirm_change_botchat_buy_filter_class"
              onclick_cancel="set"
              onclick_cancel_param="target_property=ui:interface:bot_chat_change_buy_filter_class:active|value=0" />
    <!-- Reset button -->
    <ctrl style="text_button_16"
          posref="BL BL"
          x="6"
          y="6"
          id="reset"
          onclick_l="reset_botchat_buy_filter_class"
          hardtext="uiBCFilterReset" />
  </group>
  <!-- Dialog to select the ItemType -->
  <group type="modal"
         id="bot_chat_change_buy_filter_item_type"
         w="360"
         child_resize_hmargin="8"
         child_resize_h="true"
         x="0"
         y="0"
         active="false"
         options="skin_modal"
         escapable="true"
         global_color="true">
    <!-- Title -->
    <view type="text"
          id="title"
          posref="TL TL"
          x="6"
          y="-8"
          color="255 255 255 255"
          global_color="false"
          fontsize="10"
          shadow="true"
          hardtext="uiBCTitleMPItemType" />
    <!-- List of item sheet (item type) -->
    <group type="list_sheet"
           id="list"
           nature="item"
           posref="TL TL"
           x="4"
           y="-20"
           value="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE_SELECTED"
           force_item_background_generic="true"
           wspace="2"
           hspace="2"
           array="false"
           w="350"
           lmargin="0"
           rmargin="0"
           tmargin="2"
           bmargin="2"
           child_resize_h="true"
           onclick_l="confirm_change_botchat_buy_filter_item_type"
           on_tooltip="botchat_tt_item_type"
           use_quantity="false"
           use_quality="false"
           display_empty_slot="true" />
    <!-- fake to display ALL -->
    <view type="text"
          id="no_filter"
          posparent="ctrl"
          posref="TL MM"
          x="24"
          y="-46"
          fontsize="12"
          shadow="true"
          case_mode="%case_upper"
          global_color="false"
          hardtext="uiBCNoItemTypeFilter" />
  </group>
  <!-- NB: only used for the Buy/Sell page (larger because of item info flood) -->
  <define id="trade_slot_back_w"
          value="346" />
  <define id="trade_slot_w"
          value="342" />
  <!-- The Trade Page -->
  <group id="bot_chat_trade"
         style="bot_chat_window"
         posref="BL TL"
         min_w="708"
         max_w="708"
         w="708"
         x="302"
         y="200"
         pop_max_h="700"
         max_h="2000"
         active="false"
         title="uiBotChatTrade"
         help_page="interf_bot_trade.html">
    <group id="header_opened"
           child_resize_h="true"
           w="700"
           x="0"
           y="0"
           posref="TL TL">
      <instance template="bc_border_text"
                id="intro"
                text_id="SERVER:BOTCHAT:TRADE" />
      <group id="trade_content"
             sizeref="w"
             w="0"
             child_resize_h="true"
             child_resize_hmargin="32"
             posref="BL TL"
             posparent="intro"
             y="0">
        <instance template="box_widget"
                  id="sell_back"
                  posref="TL TL"
                  w="%trade_slot_back_w"
                  h="%trade_slot_back_h"
                  x="0"
                  y="-52" />
        <instance template="box_widget"
                  id="buy_back"
                  posref="TR TR"
                  w="%trade_slot_back_w"
                  h="%trade_slot_back_h"
                  x="0"
                  y="-52" />
        <view type="text"
              id="sell_title"
              posparent="sell_back"
              posref="TL BL"
              x="0"
              y="32"
              color="255 255 255 255"
              fontsize="12"
              shadow="true"
              hardtext="uiSellTo" />
        <view type="text"
              id="buy_title"
              posparent="buy_back"
              posref="TL BL"
              x="0"
              y="32"
              color="255 255 255 255"
              fontsize="12"
              shadow="true"
              hardtext="uiBuyFrom" />
        <view type="text_formated"
              id="vendor_name"
              posparent="sell_title"
              posref="TR TL"
              x="0"
              y="0"
              color="255 255 255 255"
              global_color="false"
              fontsize="12"
              shadow="true"
              format="$s" />
        <view type="text_formated"
              id="vendor_name2"
              posparent="buy_title"
              posref="TR TL"
              x="0"
              y="0"
              color="255 255 255 255"
              global_color="false"
              fontsize="12"
              shadow="true"
              format="$s" />
        <!-- **** SELL **** -->
        <!-- GroupTab for SELL Inventory Selection -->
        <group id="inventory_select_sell"
               w="%trade_slot_w"
               h="24"
               posref="TL TL"
               x="0"
               y="-24">
          <group type="tab"
                 id="tab"
                 child_resize_w="true"
                 h="24"
                 posref="TL TL">
            <ctrl style="tab_button_new"
                  id="tab0"
                  x="0"
                  posref="TL TL"
                  hardtext="uitabBag"
                  group="sell:bag_sell" />
            <!-- MAX_INVENTORY_ANIMAL -->
            <ctrl style="tab_button_new"
                  id="tab1"
                  posparent="tab0"
                  hardtext="uitabPacker0"
                  group="sell:beast0_sell" />
            <ctrl style="tab_button_new"
                  id="tab2"
                  posparent="tab1"
                  hardtext="uitabPacker1"
                  group="sell:beast1_sell" />
            <ctrl style="tab_button_new"
                  id="tab3"
                  posparent="tab2"
                  hardtext="uitabPacker2"
                  group="sell:beast2_sell" />
            <ctrl style="tab_button_new"
                  id="tab4"
                  posparent="tab3"
                  hardtext="uitabPacker3"
                  group="sell:beast3_sell" />
            <!-- Hide the buttons if we don't own the associated animal -->
            <!-- MAX_INVENTORY_ANIMAL -->
            <link expr="isAnimalStatusPresent(@%pa_beast0:STATUS)"
                  target="tab1:active" />
            <link expr="isAnimalStatusPresent(@%pa_beast1:STATUS)"
                  target="tab2:active" />
            <link expr="isAnimalStatusPresent(@%pa_beast2:STATUS)"
                  target="tab3:active" />
            <link expr="isAnimalStatusPresent(@%pa_beast3:STATUS)"
                  target="tab4:active" />
            <!-- MAX_INVENTORY_ANIMAL -->
            <link expr="switch(@%pa_beast0:TYPE, 'uitabPacker0', 'uitabInvPAMount0', 'uitabInvPAPacker0', 'uitabInvPADemon0')"
                  target="tab1:hardtext" />
            <link expr="switch(@%pa_beast1:TYPE, 'uitabPacker1', 'uitabInvPAMount1', 'uitabInvPAPacker1', 'uitabInvPADemon1')"
                  target="tab2:hardtext" />
            <link expr="switch(@%pa_beast2:TYPE, 'uitabPacker2', 'uitabInvPAMount2', 'uitabInvPAPacker2', 'uitabInvPADemon2')"
                  target="tab3:hardtext" />
            <link expr="switch(@%pa_beast3:TYPE, 'uitabPacker3', 'uitabInvPAMount3', 'uitabInvPAPacker3', 'uitabInvPADemon3')"
                  target="tab4:hardtext" />
          </group>
          <view type="bitmap"
                id="sep"
                posparent="tab"
                posref="BR BL"
                w="1000"
                h="1"
                scale="true"
                texture="blank.tga"
                color="166 166 166 255" />
        </group>
        <!-- SELL -->
        <group id="sell"
               x="4"
               y="-54"
               child_resize_h="true"
               w="%trade_slot_w"
               posref="TL TL">
          <!-- Those groups are show/hide according to GroupTab -->
          <instance template="temp_list_sell"
                    id="bag_sell"
                    dbentry="%bag"
                    db_animal_status="" />
          <!-- MAX_INVENTORY_ANIMAL -->
          <instance template="temp_list_sell"
                    id="beast0_sell"
                    dbentry="%pa_bag0"
                    db_animal_status="%pa_beast0:STATUS" />
          <instance template="temp_list_sell"
                    id="beast1_sell"
                    dbentry="%pa_bag1"
                    db_animal_status="%pa_beast1:STATUS" />
          <instance template="temp_list_sell"
                    id="beast2_sell"
                    dbentry="%pa_bag2"
                    db_animal_status="%pa_beast2:STATUS" />
          <instance template="temp_list_sell"
                    id="beast3_sell"
                    dbentry="%pa_bag3"
                    db_animal_status="%pa_beast3:STATUS" />
        </group>
        <!-- **** BUY **** -->
        <!-- GroupTab for BUY Inventory Selection -->
        <group id="inventory_select_buy"
               w="%trade_slot_w"
               h="24"
               posref="TM TL"
               x="0"
               y="-24">
          <group type="tab"
                 id="tab"
                 child_resize_w="true"
                 h="24"
                 posref="TL TL">
            <ctrl style="tab_button_new"
                  id="tab0"
                  x="0"
                  posref="TL TL"
                  hardtext="uitabBuyNpc"
                  group="buy:general_buy"
                  onclick_l="set"
                  params_l="dblink=UI:VARIABLES:BOTCHAT:BUY_LIST_SELECTED|value=0" />
            <ctrl style="tab_button_new"
                  id="tab1"
                  posparent="tab0"
                  hardtext="uitabBuyResale"
                  group="buy:resale_buy"
                  onclick_l="set"
                  params_l="dblink=UI:VARIABLES:BOTCHAT:BUY_LIST_SELECTED|value=0" />
            <ctrl style="tab_button_new"
                  id="tab2"
                  posparent="tab1"
                  hardtext="uitabBuyPlayer"
                  group="buy:player_buy"
                  onclick_l="set"
                  params_l="dblink=UI:VARIABLES:BOTCHAT:BUY_LIST_SELECTED|value=1" />
          </group>
          <view type="bitmap"
                id="sep"
                posparent="tab"
                posref="BR BL"
                w="1000"
                h="1"
                scale="true"
                texture="blank.tga"
                color="166 166 166 255" />
        </group>
        <!-- BUY -->
        <group id="buy"
               child_resize_h="true"
               x="-4"
               y="-54"
               w="%trade_slot_w"
               posref="TR TR">
          <!-- Those groups are show/hide according to GroupTab -->
          <!--
                                <instance template="temp_list_buy" id="general_buy" use_quantity="true" filter_seller_type="npc_and_resale" />
                                -->
          <instance template="temp_list_buy"
                    id="general_buy"
                    use_quantity="true"
                    filter_seller_type="npc" />
          <instance template="temp_list_buy"
                    id="resale_buy"
                    use_quantity="true"
                    filter_seller_type="resale" />
          <instance template="temp_list_buy"
                    id="player_buy"
                    use_quantity="true"
                    filter_seller_type="user" />
        </group>
        <!-- **** MISC **** -->
        <!-- CURRENT MONEY OF PLAYER -->
        <instance template="argent"
                  id="money"
                  posref="BL TL"
                  x="0"
                  y="-4"
                  w="150"
                  h="16"
                  posparent="sell_back"
                  value="%money" />
        <!-- CURRENT SKILL POINTS -->
        <instance template="skill_points_widget2"
                  id="sp"
                  posref="BL TL"
                  y="-4"
                  posparent="money"
                  value="UI:TEMP:SP" />
        <instance template="skill_points_copy"
                  id="pipo" />
        <!-- REFRESH -->
        <group id="refresh_group"
               h="16"
               child_resize_w="true"
               posparent="sell_back"
               posref="BL TL"
               x="0"
               y="-30">
          <ctrl style="text_button_16"
                id="refresh_button"
                posref="ML ML"
                x="0"
                y="0"
                onclick_l="botchat_refresh_resale"
                hardtext="uiBotChatRefresh"
                tooltip="uittBotChatRefresh" />
        </group>
        <!-- AUTO-RESET FILTERS -->
        <instance template="check_box"
                  id="auto_reset"
                  posparent="sell_back"
                  posref="BL TL"
                  x="0"
                  y="-52"
                  hardtext="uiBCAutoReset"
                  tooltip="uittBCAutoReset"
                  dblink="UI:SAVE:BOTCHAT_FILTER:RESET_ON_OPEN" />
        <!-- **** RESALE FILTERS **** -->
        <group id="buy_resale_options"
               child_resize_h="true"
               child_resize_w="true"
               posparent="buy_back"
               posref="BR TR"
               x="0"
               y="-8">
          <!-- price filter -->
          <instance template="botchat_buy_filter"
                    id="botchat_buy_filter_price"
                    posparent="parent"
                    posref="TR TR"
                    x="0"
                    y="0"
                    h="16"
                    text="uiBCFilterPrice"
                    dialog_title="uiBCTitleFilterPrice"
                    dbext="PRICE"
                    maxvalue="%bot_chat_filter_max_price" />
          <!-- quality filter -->
          <instance template="botchat_buy_filter"
                    id="botchat_buy_filter_quality"
                    posparent="botchat_buy_filter_price"
                    posref="TL TR"
                    x="-4"
                    y="0"
                    h="16"
                    text="uiBCFilterQuality"
                    dialog_title="uiBCTitleFilterQuality"
                    dbext="QUALITY"
                    maxvalue="%bot_chat_filter_max_quality" />
          <!-- class filter -->
          <group id="botchat_buy_filter_class"
                 posparent="botchat_buy_filter_quality"
                 posref="TL TR"
                 x="-4"
                 y="0"
                 h="16"
                 child_resize_w="true"
                 child_resize_wmargin="8">
            <ctrl style="text_button_16"
                  id="ctrl"
                  posref="ML ML"
                  hardtext="uiBCFilterClass"
                  x="4"
                  onclick_l="enter_change_botchat_buy_filter_class" />
            <view type="text"
                  id="text"
                  posparent="ctrl"
                  posref="MR ML"
                  fontsize="10"
                  x="2"
                  y="-1" />
            <!-- transform 0-4 to 1-5 -->
            <link expr="getBotChatBuyFilter(add(@UI:SAVE:BOTCHAT_FILTER:MIN_CLASS,1),add(@UI:SAVE:BOTCHAT_FILTER:MAX_CLASS,1))"
                  target="text:hardtext" />
          </group>
          <!-- item part filter -->
          <group id="botchat_buy_filter_mp_item_part"
                 posref="TR TR"
                 x="0"
                 y="-24"
                 h="40"
                 child_resize_w="true"
                 child_resize_wmargin="8">
            <ctrl style="text_button_16"
                  id="ctrl"
                  posref="ML ML"
                  hardtext="uiBCMPItemPart"
                  x="4"
                  onclick_l="enter_change_botchat_buy_filter_mp" />
            <view type="bitmap"
                  id="bmp"
                  posparent="ctrl"
                  posref="MR ML"
                  x="2"
                  y="0"
                  w="24"
                  h="24"
                  scale="true"
                  global_color="false" />
            <ctrl type="tooltip"
                  id="tt"
                  posparent="bmp"
                  posref="TL TL"
                  sizeref="wh" />
            <link expr="getBotChatBuyFilterMPIcon(@UI:SAVE:BOTCHAT_FILTER:MP_ITEM_PART)"
                  target="bmp:texture" />
            <link expr="getBotChatBuyFilterMPText(@UI:SAVE:BOTCHAT_FILTER:MP_ITEM_PART)"
                  target="tt:tooltip" />
          </group>
          <!-- item type filter -->
          <group id="botchat_buy_filter_item_type"
                 posparent="botchat_buy_filter_mp_item_part"
                 posref="TL TR"
                 x="0"
                 y="0"
                 h="40"
                 child_resize_w="true"
                 child_resize_wmargin="8">
            <ctrl style="text_button_16"
                  id="ctrl"
                  posref="ML ML"
                  hardtext="uiBCItemType"
                  x="4"
                  onclick_l="enter_change_botchat_buy_filter_item_type" />
            <ctrl type="sheet"
                  nature="item"
                  id="icon_filter"
                  posparent="ctrl"
                  posref="MR ML"
                  x="4"
                  value="UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE"
                  force_item_background_generic="true"
                  on_tooltip="botchat_tt_item_type"
                  use_quantity="false"
                  use_quality="false"
                  onclick_l="enter_change_botchat_buy_filter_item_type" />
            <view type="text"
                  id="no_filter"
                  posparent="ctrl"
                  posref="MR ML"
                  x="4"
                  y="-2"
                  fontsize="12"
                  shadow="true"
                  case_mode="%case_upper"
                  global_color="false"
                  hardtext="uiBCNoItemTypeFilter" />
            <!-- show the right "icon" according to item type filter -->
            <link expr="@UI:SAVE:BOTCHAT_FILTER:ITEM_TYPE"
                  action="set"
                  params="dblink=UI:VARIABLES:BOTCHAT:FILTER_ITEM_TYPE:SHEET|value=getBotChatItemSheetForItemType(@UI:SAVE:BOTCHAT_FILTER:ITEM_TYPE)" />
            <!-- hide or show the icon/text if any filter or not -->
            <link expr="eq(@UI:SAVE:BOTCHAT_FILTER:ITEM_TYPE,%item_type_unknown)"
                  target="no_filter:active" />
            <link expr="ne(@UI:SAVE:BOTCHAT_FILTER:ITEM_TYPE,%item_type_unknown)"
                  target="icon_filter:active" />
          </group>
          <!-- display filters according to actual bot filters -->
          <link expr="ne(@SERVER:TRADING:RAW_MATERIAL_SELLER,0)"
                target="botchat_buy_filter_mp_item_part:active" />
          <link expr="or(ne(@SERVER:TRADING:ITEM_TYPE_SELLER_BITFILED_0_63,0),ne(@SERVER:TRADING:ITEM_TYPE_SELLER_BITFILED_64_127,0))"
                target="botchat_buy_filter_item_type:active" />
        </group>
        <!-- Selection of group according to tab selected -->
        <link expr="eq(@UI:VARIABLES:BOTCHAT:BUY_LIST_SELECTED,0)"
              target="buy_resale_options:active" />
      </group>
    </group>
  </group>
  <!-- ******************************************** -->
  <!-- *     BOT CHAT PAGE FOR TRADE : BUY ONLY   * -->
  <!-- ******************************************** -->
  <group id="bot_chat_buy"
         style="bot_chat_window"
         posref="BL TL"
         min_w="450"
         max_w="450"
         w="450"
         x="352"
         y="200"
         pop_max_h="700"
         max_h="2000"
         active="false"
         title="uiLearn">
    <group id="header_opened"
           child_resize_h="true"
           w="600"
           x="0"
           y="0"
           posref="TL TL">
      <instance template="bc_border_text"
                id="intro"
                text_id="SERVER:BOTCHAT:TRADE" />
      <group id="trade_content"
             sizeref="w"
             w="0"
             child_resize_h="true"
             child_resize_hmargin="56"
             posref="BL TL"
             posparent="intro"
             y="0">
        <instance template="box_widget"
                  id="buy_back"
                  posref="TR TR"
                  w="430"
                  h="%trade_slot_back_h"
                  x="0"
                  y="-48" />
        <view type="text"
              id="buy_title"
              posparent="buy_back"
              posref="TL BL"
              x="0"
              y="24"
              color="255 255 255 255"
              fontsize="12"
              shadow="true"
              hardtext="uiLearnFrom" />
        <view type="text_formated"
              id="vendor_name"
              posparent="buy_title"
              posref="TR TL"
              x="0"
              y="0"
              color="255 255 255 255"
              global_color="false"
              fontsize="12"
              shadow="true"
              format="$s" />
        <!-- GroupTab for BUY Inventory Selection -->
        <group id="buy_filter"
               w="430"
               h="24"
               posref="TL TL"
               x="0"
               y="-24">
          <group type="tab"
                 id="tab"
                 child_resize_w="true"
                 h="24"
                 posref="TL TL">
            <ctrl style="tab_button_new"
                  id="tab0"
                  x="0"
                  posref="TL TL"
                  hardtext="uitabBuyAll"
                  group="buy:general_buy"
                  tooltip="uittTabBuyAll" />
            <ctrl style="tab_button_new"
                  id="tab1"
                  posparent="tab0"
                  hardtext="uitabBuyAction"
                  group="buy:action_buy"
                  tooltip="uittTabBuyAction" />
            <ctrl style="tab_button_new"
                  id="tab2"
                  posparent="tab1"
                  hardtext="uitabBuyUpgrade"
                  group="buy:upgrade_buy"
                  tooltip="uittTabBuyUpgrade" />
            <ctrl style="tab_button_new"
                  id="tab3"
                  posparent="tab2"
                  hardtext="uitabBuyPower"
                  group="buy:power_buy"
                  tooltip="uittTabBuyPower" />
            <ctrl style="tab_button_new"
                  id="tab4"
                  posparent="tab3"
                  hardtext="uitabBuyCarac"
                  group="buy:carac_buy"
                  tooltip="uittTabBuyCarac" />
          </group>
          <view type="bitmap"
                id="sep"
                posparent="tab"
                posref="BR BL"
                w="1000"
                h="1"
                scale="true"
                texture="blank.tga"
                color="166 166 166 255" />
        </group>
        <!-- BUY -->
        <group id="buy"
               child_resize_h="true"
               x="0"
               y="-52"
               w="430"
               posref="TL TL">
          <!-- No Reseller filter -->
          <instance template="temp_list_buy"
                    id="general_buy"
                    use_quantity="false"
                    filter_seller_type="" />
          <instance template="temp_list_buy"
                    id="action_buy"
                    use_quantity="false"
                    filter_seller_type="action" />
          <instance template="temp_list_buy"
                    id="upgrade_buy"
                    use_quantity="false"
                    filter_seller_type="upgrade" />
          <instance template="temp_list_buy"
                    id="power_buy"
                    use_quantity="false"
                    filter_seller_type="power" />
          <instance template="temp_list_buy"
                    id="carac_buy"
                    use_quantity="false"
                    filter_seller_type="carac" />
        </group>
        <!-- CURRENT MONEY OF PLAYER -->
        <instance template="argent"
                  id="money"
                  posref="BL TL"
                  x="0"
                  y="-8"
                  w="150"
                  h="16"
                  posparent="buy_back"
                  value="%money" />
        <!-- CURRENT FACTION POINTS OF PLAYER -->
        <instance template="faction_points_widget"
                  id="fp"
                  posref="BL TL"
                  x="0"
                  y="-8"
                  posparent="money" />
        <!-- CURRENT SKILL POINTS -->
        <instance template="skill_points_widget2"
                  id="sp"
                  posref="BL TL"
                  y="-4"
                  posparent="money"
                  value="UI:TEMP:SP" />
        <instance template="skill_points_copy"
                  id="pipo" />
        <!-- CURRENT PLAYER MONEY AND GUILD XP -->
        <group id="money_guild_xp"
               posref="BL TL"
               posparent="buy_back"
               x="0"
               y="-8"
               w="250"
               h="16">
          <instance template="argent"
                    id="money"
                    posref="TL TL"
                    w="120"
                    h="16"
                    value="%money" />
          <view type="text"
                id="xp_text"
                posref="TR TL"
                x="4"
                y="-3"
                posparent="money"
                color="255 255 255 255"
                shadow="true"
                fontsize="12"
                hardtext="uiGuildXP"
                global_color="false" />
          <view type="text_number"
                id="xp_value"
                posref="TR TL"
                posparent="xp_text"
                x="4"
                y="0"
                color="255 255 255 255"
                shadow="true"
                fontsize="12"
                value="%guild_xp"
                global_color="false" />
        </group>
        <!-- CURRENT GUILD MONEY AND GUILD XP -->
        <group id="guild_money_guild_xp"
               posref="BL TL"
               posparent="buy_back"
               x="0"
               y="-8"
               w="250"
               h="16">
          <instance template="argent"
                    id="guild_money"
                    posref="TL TL"
                    w="120"
                    h="16"
                    value="%guild_inv_money"
                    tooltip="uittGuildMoney" />
          <view type="text"
                id="xp_text"
                posref="TR TL"
                x="4"
                y="-3"
                posparent="guild_money"
                color="255 255 255 255"
                shadow="true"
                fontsize="12"
                hardtext="uiGuildXP"
                global_color="false" />
          <view type="text_number"
                id="xp_value"
                posref="TR TL"
                posparent="xp_text"
                x="4"
                y="0"
                color="255 255 255 255"
                shadow="true"
                fontsize="12"
                value="%guild_xp"
                global_color="false" />
        </group>
      </group>
    </group>
  </group>
  <!-- ************************************** -->
  <!-- *     BOT CHAT PAGE FOR NEWS         * -->
  <!-- ************************************** -->
  <group id="bot_chat_news"
         style="bot_chat_window"
         posref="BL TL"
         min_w="320"
         max_w="320"
         w="320"
         x="352"
         y="200"
         pop_max_h="700"
         max_h="2000"
         active="false"
         title="uiBotChatNews">
    <group id="header_opened"
           child_resize_h="true"
           w="288"
           x="16"
           y="0"
           posref="TL TL">
      <instance template="bc_border_text"
                id="intro"
                text_id="SERVER:BOTCHAT:NEWS" />
      <group id="pipo"
             posparent="intro"
             posref="BL TL"
             h="20" />
    </group>
  </group>
  <!-- ************************************** -->
  <!-- *     BOT CHAT PAGE FOR MISSION END  * -->
  <!-- ************************************** -->
  <group id="bot_chat_mission_end"
         style="bot_chat_window"
         posref="BL TL"
         min_w="188"
         max_w="188"
         w="188"
         x="352"
         y="200"
         pop_max_h="700"
         max_h="2000"
         active="false"
         title="uiBotChatMissionEnd">
    <group id="header_opened"
           child_resize_h="true"
           child_resize_hmargin="16"
           w="180"
           x="0"
           y="0"
           posref="TL TL">
      <!-- reward text -->
      <instance template="bc_border_text"
                id="reward_text"
                text_id="SERVER:BOTCHAT:MISSION_END_REWARD" />
      <!-- reward slots -->
      <group id="reward_slots"
             posparent="reward_text"
             posref="BL TL"
             child_resize_h="true"
             sizeref="w"
             w="0"
             y="-4">
        <group id="slots"
               child_resize_h="true"
               child_resize_w="true"
               posref="TM TM">
          <ctrl type="sheet"
                id="gift0"
                onclick_r="open_help_auto"
                value="%exchange_receive:0"
                dragable="true"
                posref="TL TL"
                x="0"
                y="0"
                selection_group="inventory_selection" />
          <ctrl type="sheet"
                id="gift1"
                onclick_r="open_help_auto"
                value="%exchange_receive:1"
                dragable="true"
                posparent="gift0"
                posref="TR TL"
                x="2"
                selection_group="inventory_selection" />
          <ctrl type="sheet"
                id="gift2"
                onclick_r="open_help_auto"
                value="%exchange_receive:2"
                dragable="true"
                posparent="gift1"
                posref="TR TL"
                x="2"
                selection_group="inventory_selection" />
          <ctrl type="sheet"
                id="gift3"
                onclick_r="open_help_auto"
                value="%exchange_receive:3"
                dragable="true"
                posparent="gift2"
                posref="TR TL"
                x="2"
                selection_group="inventory_selection" />
        </group>
        <view type="text"
              id="drag_to_inventory"
              posref="BM TM"
              posparent="slots"
              y="-4"
              color="255 255 255 255"
              multi_line="true"
              line_maxw="180"
              multi_line_space="0"
              max_fontsize="10"
              shadow="true"
              hardtext="uiDragToInventory" />
      </group>
      <!-- end mission text -->
      <instance template="bc_border_text"
                posref="BL TL"
                id="mission_end_text"
                posparent="reward_slots"
                w="0"
                y="-2"
                text_id="SERVER:BOTCHAT:MISSION_END" />
      <group id="pipo"
             posparent="mission_end_text"
             posref="BL TL"
             h="4" />
      <!-- accept next step -->
      <!--
                <group id="accept" posref="BR TR" posparent="mission_end_text" child_resize_h="true" child_resize_w="true">
                        <ctrl type="button" id="confirm_button"                  posref="TR TR" x="0" y="0" button_type="push_button" onclick_l="accept_next_step" tx_normal="w_answer_16_valid.tga" tx_pushed="w_answer_16_valid.tga" tx_over="W_button_16_over.tga" global_color_normal="false" global_color_pushed="false"/>
                        <view type="text"   id="sell_text"                               posref="ML MR" posparent="confirm_button" x="-8" y="0" color="255 255 255 255" fontsize="10" shadow="true" hardtext="uiSell"           active="false" global_color="false" />
                </group>
                -->
    </group>
  </group>
  <!-- ***************************************** -->
  <!-- *     BOT CHAT PAGE FOR DYNAMIC MISSION * -->
  <!-- ***************************************** -->
  <variable entry="UI:TEMP:DYNAMIC_MISSION:CHOICE0"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:DYNAMIC_MISSION:CHOICE1"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:DYNAMIC_MISSION:CHOICE2"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:DYNAMIC_MISSION_VALID"
            type="sint32"
            value="0" />
  <group id="bot_chat_dynamic_mission"
         style="bot_chat_window"
         posref="BL TL"
         min_w="320"
         max_w="320"
         w="320"
         x="352"
         y="200"
         pop_max_h="700"
         max_h="2000"
         active="false"
         title="uiBotChatDynamicMission">
    <group id="header_opened"
           child_resize_h="true"
           child_resize_hmargin="24"
           w="288"
           x="16"
           y="-8"
           posref="TL TL">
      <!-- choice 0 
                <instance template="bc_border_text" id="choice0_title" text_id="SERVER:BOTCHAT:DM_CHOICE0:TITLE"/> -->
      <view type="text_id_formated"
            format="$t"
            id="choice0_title"
            posref="TL TL"
            y="-24"
            textid="SERVER:BOTCHAT:DM_CHOICE0:TITLE"
            multi_line="true"
            fontsize="12"
            shadow="true"
            global_color="false" />
      <!-- combo box for choice 0-->
      <group type="combo_box"
             id="choice0"
             w="308"
             h="20"
             posparent="choice0_title"
             value="UI:TEMP:DYNAMIC_MISSION:CHOICE0"
             posref="BL TL"
             x="0"
             y="0">
        <instance template="combo_box_def1" />
      </group>
      <!-- choice 1 
                <instance template="bc_border_text" id="choice1_title" posparent="choice0_title" posref="BL TL" w="0" y="-40" text_id="SERVER:BOTCHAT:DM_CHOICE1:TITLE"/>-->
      <view type="text_id_formated"
            format="$t"
            id="choice1_title"
            posref="BL TL"
            w="0"
            y="-20"
            posparent="choice0"
            textid="SERVER:BOTCHAT:DM_CHOICE1:TITLE"
            multi_line="true"
            fontsize="12"
            shadow="true"
            global_color="false" />
      <!-- combo box for choice 1-->
      <group type="combo_box"
             id="choice1"
             w="308"
             h="20"
             posparent="choice1_title"
             value="UI:TEMP:DYNAMIC_MISSION:CHOICE1"
             posref="BL TL"
             x="0"
             y="0">
        <instance template="combo_box_def1" />
      </group>
      <!-- choice 2 
                <instance template="bc_border_text" id="choice2_title" posparent="choice1_title" posref="BL TL" w="0" y="-40" text_id="SERVER:BOTCHAT:DM_CHOICE2:TITLE"/> -->
      <view type="text_id_formated"
            format="$t"
            id="choice2_title"
            posparent="choice1"
            posref="BL TL"
            w="0"
            y="-20"
            textid="SERVER:BOTCHAT:DM_CHOICE2:TITLE"
            multi_line="true"
            fontsize="12"
            shadow="true"
            global_color="false" />
      <!-- combo box for choice 2-->
      <group type="combo_box"
             id="choice2"
             w="308"
             h="20"
             posparent="choice2_title"
             value="UI:TEMP:DYNAMIC_MISSION:CHOICE2"
             posref="BL TL"
             x="0"
             y="0">
        <instance template="combo_box_def1" />
      </group>
      <group id="result"
             w="308"
             child_resize_h="true"
             posparent="choice2"
             posref="BL TL"
             y="-20">
        <!-- text that contains the result mission title -->
        <instance template="bc_border_text2"
                  id="dm_title"
                  posref="TL TL"
                  w="308"
                  y="0"
                  text_id="SERVER:BOTCHAT:DM_TITLE" />
        <link expr="ne(@UI:TEMP:DYNAMIC_MISSION_VALID, 0)"
              target="dm_title:active" />
        <!-- text that contains the result mission description -->
        <instance template="bc_border_text2"
                  id="dm_description"
                  posparent="dm_title"
                  posref="BL TL"
                  w="308"
                  y="-16"
                  text_id="SERVER:BOTCHAT:DM_DESCRIPTION" />
        <link expr="ne(@UI:TEMP:DYNAMIC_MISSION_VALID, 0)"
              target="dm_description:active" />
        <group id="blank"
               w="308"
               h="20"
               posparent="dm_description"
               posref="BL TL"
               y="0" />
        <link expr="ne(@UI:TEMP:DYNAMIC_MISSION_VALID, 0)"
              target="blank:active" />
      </group>
      <!-- button to regenerate the mission -->
      <ctrl style="text_button_16"
            id="regen_button"
            posparent="result"
            posref="BR TR"
            x="0"
            y="0"
            onclick_l="regen_dm"
            hardtext="uiRegenerateDM" />
      <link expr="eq(@UI:TEMP:DYNAMIC_MISSION_VALID, 0)"
            target="regen_button:frozen" />
      <!-- button to accept the mission -->
      <ctrl style="text_button_16"
            id="accept_button"
            posparent="regen_button"
            posref="BR TR"
            x="0"
            y="-4"
            onclick_l="accept_dm"
            hardtext="uiAcceptDM" />
      <link expr="eq(@UI:TEMP:DYNAMIC_MISSION_VALID, 0)"
            target="accept_button:frozen" />
      <!-- links to run an action handler when selection is changed -->
      <link expr="depends(@UI:TEMP:DYNAMIC_MISSION:CHOICE0)"
            action="change_dm_option"
            params="id=0" />
      <link expr="depends(@UI:TEMP:DYNAMIC_MISSION:CHOICE1)"
            action="change_dm_option"
            params="id=1" />
      <link expr="depends(@UI:TEMP:DYNAMIC_MISSION:CHOICE2)"
            action="change_dm_option"
            params="id=2" />
    </group>
  </group>
  <!-- ******************************** -->
  <!-- *   BOT CHAT PAGE FOR MISSIONS * -->
  <!-- ******************************** -->
  <!-- Mission Page is used for :
        - Mission
        - ZC Charge acquiring
        - Building acquiring
        - BotMaster Buy
        - BotMaster Upgrade
-->
  <variable entry="UI:TEMP:MISSION:ICON"
            type="sint32"
            value="0" />
  <variable entry="UI:TEMP:MISSION:MISSION_TYPE"
            type="sint32"
            value="0" />
  <!-- box to see mission content and to accept it -->
  <!-- The Sheet (item/brick) Help Widget -->
  <group type="container"
         id="bot_chat_accept_mission"
         w="320"
         h="80"
         title="uiMissionDetails"
         global_color="false"
         options="layer0_info"
         opened="true"
         openable="false"
         movable="true"
         resizer="false"
         win_priority="%win_priority_high"
         active="false"
         savable="false"
         escapable="true"
         header_color="UI:SAVE:WIN:COLORS:BOT">
    <group id="header_closed"
           x="0"
           y="0"
           w="0"
           h="16"
           posref="TL TL"></group>
    <group id="header_opened"
           x="0"
           y="0"
           w="0"
           h="16"
           posref="TL TL"></group>
    <group id="content"
           x="0"
           y="0"
           w="0"
           child_resize_h="true"
           child_resize_hmargin="6"
           posref="TL TL">
      <!-- Item is in auto mode -->
      <ctrl type="sheet"
            id="ctrl_slot"
            nature="mission"
            value="UI:TEMP:MISSION"
            posref="TR TR"
            x="-4"
            y="-10"
            use_quantity="false" />
      <!-- the scroll text id (use for missions) -->
      <group id="scroll_text_id"
             posref="TL TL"
             w="0"
             y="-6"
             sizeref="w"
             child_resize_h="true"
             child_resize_hmargin="8">
        <instance template="inner_thin_border_group" />
        <group id="minh"
               posref="TL TL"
               x="0"
               y="0"
               w="1"
               h="42" />
        <group id="text_list"
               posref="TL TL"
               x="12"
               y="-4"
               sizeref="w"
               w="-64"
               child_resize_h="true"
               max_h="392">
          <view type="text_id"
                id="text_title_id"
                multi_line="true"
                multi_line_space="0"
                posref="TL TL" />
          <view type="text_id_formated"
                id="text_id"
                posparent="text_title_id"
                posref="BL TL"
                y="-10"
                multi_line="true"
                multi_line_space="0" />
        </group>
        <ctrl style="skin_scroll"
              id="sv"
              posref="TL TL"
              x="4"
              y="-4"
              target_stepy="14"
              target="text_list" />
      </group>
      <!-- the accept button -->
      <!-- option to accept the selected mission -->
      <group id="accept_mission"
             posparent="scroll_text_id"
             posref="BR TR"
             x="0"
             y="-4"
             h="16"
             child_resize_w="true">
        <instance template="button_ok_cancel"
                  posref="TR TR"
                  ok_text="uiAccept"
                  cancel_text="uiRefuse"
                  onclick_ok="accept_mission"
                  onclick_cancel="set"
                  onclick_cancel_param="target_property=ui:interface:bot_chat_accept_mission:active|value=0" />
      </group>
    </group>
  </group>
  <define id="mission_slot_height"
          value="414" />
  <define id="mission_back_height"
          value="420" />
  <group id="bot_chat_missions"
         style="bot_chat_window"
         posref="BL TL"
         min_w="316"
         max_w="316"
         w="316"
         x="352"
         y="200"
         pop_max_h="700"
         max_h="2000"
         active="false"
         title="uiBotChatMissions"
         modal_parent="gestionsets">
    <group id="header_opened"
           child_resize_h="true"
           child_resize_hmargin="24"
           w="600"
           x="0"
           y="0"
           posref="TL TL">
      <instance template="bc_border_text"
                id="intro"
                text_id="SERVER:BOTCHAT:CHOOSE_MISSION" />
      <instance template="box_widget"
                id="mission_back"
                posref="BL TL"
                w="296"
                h="%mission_back_height"
                x="0"
                posparent="intro"
                y="-24" />
      <view type="text"
            id="mission_title"
            posparent="mission_back"
            posref="TL BL"
            x="0"
            y="0"
            color="255 255 255 255"
            fontsize="12"
            shadow="true"
            hardtext="uiSelectMission" />
      <group id="missions_content"
             w="292"
             child_resize_h="true"
             posref="TL TL"
             posparent="mission_back"
             x="0"
             y="-3">
        <!-- LIST OF MISSIONS  -->
        <!-- The H should be "42+hspace" * Number of rows. Setup list.max_h too below-->
        <group type="list_sheet_mission"
               sizeref="w"
               w="0"
               x="2"
               y="0"
               h="%mission_slot_height"
               id="missions"
               posref="TL TL"
               xitem="2"
               yitem="-2"
               xtext="46"
               ytext="-2"
               hspace="4"
               array="false"
               value="LOCAL:CHOOSE_MISSIONS"
               want_price="false"
               click_when_pushed="true"
               use_quantity="false"
               use_quality="false"
               dragable="false"
               use_slot_type_db_entry="false"
               nature="mission"
               onclick_l="select_mission"
               onclick_r="open_help_auto"
               over_color="%bot_chat_sheet_selection_normal"
               over_col_pushed="%bot_chat_sheet_selection_pushed"
               over_col_over="%bot_chat_sheet_selection_over"
               color="255 255 255 255"
               fontsize="10"
               shadow="true"
               multi_line="true"
               multi_line_space="0"
               multi_max_line="3">
          <!-- the scroll -->
          <ctrl style="skin_scroll"
                id="scroll_row"
                posref="TL TL"
                x="2"
                target_stepy="46" />
          <!-- the group to scroll -->
          <group id="list"
                 sizeref="w"
                 posref="TL TL"
                 max_h="%mission_slot_height"
                 x="12"
                 y="0"
                 w="-12"
                 h="0" />
        </group>
      </group>
      <!-- The XP Guild, show only for bot RoleMaster buying -->
      <group id="xp_guild"
             posparent="mission_back"
             posref="BL TL"
             x="0"
             y="-3"
             w="300"
             h="16"
             active="false">
        <view type="text"
              id="text"
              posref="ML ML"
              x="0"
              y="0"
              color="255 255 255 255"
              fontsize="12"
              shadow="true"
              hardtext="uiXpGuild" />
        <view type="text_number"
              id="value"
              posparent="text"
              posref="MR ML"
              x="0"
              y="0"
              color="255 255 255 255"
              fontsize="12"
              shadow="true"
              value="SERVER:GUILD:XP" />
      </group>
      <!-- The Day before next ZC distrib, show only for bot ZCDutyGiver -->
      <group id="zc_duty"
             posparent="mission_back"
             posref="BL TL"
             x="0"
             y="-3"
             w="300"
             h="16"
             active="false">
        <view type="text"
              id="text"
              posref="ML ML"
              x="0"
              y="0"
              color="255 255 255 255"
              fontsize="12"
              shadow="true"
              hardtext="uiDayBeforeNextZCDistrib" />
        <view type="text_number"
              id="value"
              posparent="text"
              posref="MR ML"
              x="0"
              y="0"
              color="255 255 255 255"
              fontsize="12"
              shadow="true"
              value="UI:VARIABLES:DAY_BEFORE_ZC_DISTRIB" />
      </group>
    </group>
  </group>
  
  <group id="bot_chat_object" w="640" h="480" posref="MM MM" active="false">
	<!-- Vue Globale -->
	<view type="bitmap" id="black" posparent="bot_chat_object" posref="MM MM" sizeref="wh" w="-2" h="-2" inherit_gc_alpha="true" scale="true" texture="blank.tga" color="0 0 0 160"/>

	<scene3d id="scene3d" x="-3" y="-3" w="640" h="480" posref="TR TR" curcam="cam" curcs="env" render_layer="-2"
						user_interaction="true" rotz_factor="0.017"
						roty_factor="0.005" roty_limit_min="-80" roty_limit_max="90"
						dist_factor="0.005" dist_limit_min="0.5" dist_limit_max="10.0"
						ambient="128 96 64" sun_ambient="0 0 0" sun_diffuse="255 255 196" sun_specular="0 0 0" sun_direction="-1.0 1.0 -1.0" >
						
	
		<camera id="cam" fov="80" pos="0.0 24.0 2.6" target="0.0 26.5 2.2" roll="0" />
		<camera id="camface" fov="20" pos="0.0 25.0 2.2" target="0.0 26.5 2.2" roll="0" />

		<light id="back" pos="0.0 28.2 1.6" color="255 255 255" near="2.5" far="4.0" />
		<light id="lgt" pos="0.0 25.3 2.48" color="255 255 255" near="3.0" far="4.0" />
			
		<shape id="object_1" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
		<shape id="object_2" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
		<shape id="object_3" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
		<shape id="object_4" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
		<shape id="object_5" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
		<shape id="object_6" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
		<shape id="object_7" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
		<shape id="object_8" name="tr_mo_dag.shape" pos="0.0 26.5 2.0" rot="0.0 0.0 0.0" />
					
	</scene3d>
	<ctrl style="text_button_16"
		  id="quit_scene"
		  posparent="bot_chat_object"
		  posref="TR TR"
		  x="-5"
		  y="-5"
		  hardtext="uiClose"
		  color="255 255 255 255"
		  col_over="255 255 255 255"
		  col_pushed="255 255 255 255"
		  global_color_normal="true"
		  global_color_over="true"
		  global_color_pushed="true"
		  onclick_l="set"
		  params_l="target_property=ui:interface:bot_chat_object:active|value=0" />
	
	
  </group>
  
  <link expr="depends(@UI:TEMP:MISSION:MISSION_TYPE)"
        action="lua:game:bcMissionsUpdate()" />
  <!-- instance of the various botchat programs -->
  <tree node="bot_chat_player_gift"></tree>
  <tree node="bot_chat_create_guild"></tree>
  <tree node="bot_chat_missions"></tree>
  <tree node="bot_chat_dynamic_mission"></tree>
  <tree node="bot_chat_trade"></tree>
  <tree node="bot_chat_buy"></tree>
  <tree node="bot_chat_news"></tree>
  <tree node="bot_chat_mission_end"></tree>
  <tree node="bot_chat_accept_mission"></tree>
  <tree node="bot_chat_buy_sell_item"></tree>
  <tree node="bot_chat_object"></tree>
</interface_config>
