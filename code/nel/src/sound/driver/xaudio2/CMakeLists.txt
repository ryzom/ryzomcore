FILE(GLOB SRC *.cpp *.h)

ADD_LIBRARY(nel_drv_xaudio2 SHARED ${SRC})

INCLUDE_DIRECTORIES(${LIBXML2_INCLUDE_DIR} ${DXSDK_INCLUDE_DIR} ${VORBIS_INCLUDE_DIR} ${OGG_INCLUDE_DIR})
TARGET_LINK_LIBRARIES(nel_drv_xaudio2 ${LIBXML2_LIBRARIES} nelsnd_lowlevel ${DXSDK_XAUDIO_LIBRARY} ${DXSDK_GUID_LIBRARY} ${VORBIS_LIBRARIES} ${OGG_LIBRARY})
SET_TARGET_PROPERTIES(nel_drv_xaudio2 PROPERTIES
  VERSION ${NL_VERSION}
  SOVERSION ${NL_VERSION_MAJOR})
ADD_DEFINITIONS(${LIBXML2_DEFINITIONS})

IF(WIN32)
  SET_TARGET_PROPERTIES(nel_drv_xaudio2 PROPERTIES COMPILE_FLAGS "/Yustdxaudio2.h")
  SET_SOURCE_FILES_PROPERTIES(stdxaudio2.cpp PROPERTIES COMPILE_FLAGS "/Ycstdxaudio2.h")
  SET_TARGET_PROPERTIES(nel_drv_xaudio2 PROPERTIES 
    LINK_FLAGS "/NODEFAULTLIB:libcmt"
    DEBUG_POSTFIX "_d"
    RELEASE_POSTFIX "_r"
    PROJECT_LABEL "Driver, Sound: XAudio2")
ENDIF(WIN32)

INSTALL(TARGETS nel_drv_xaudio2 RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib COMPONENT driverssound)
IF(WITH_MAXPLUGIN)
  INSTALL(TARGETS nel_drv_xaudio2 RUNTIME DESTINATION maxplugin COMPONENT driverssound)
ENDIF(WITH_MAXPLUGIN)
