FILE(GLOB SRC *.cpp)
FILE(GLOB PRIV_H *.h)
FILE(GLOB PUB_H ../../include/nel/georges/*.h)

SOURCE_GROUP(headers FILES ${PRIV_H} ${PUB_H})

IF(NOT WIN32)
  ADD_LIBRARY(nelgeorges SHARED ${SRC})
  CONFIGURE_FILE(nel-georges.pc.in nel-georges.pc)
  INSTALL(FILES "${CMAKE_CURRENT_BINARY_DIR}/nel-georges.pc" DESTINATION lib/pkgconfig)
ELSE(NOT WIN32)
  ADD_LIBRARY(nelgeorges STATIC ${SRC})
ENDIF(NOT WIN32)

INCLUDE_DIRECTORIES(${LIBXML2_INCLUDE_DIR})
TARGET_LINK_LIBRARIES(nelgeorges nelmisc)
SET_TARGET_PROPERTIES(nelgeorges PROPERTIES 
  VERSION ${NL_VERSION}
  SOVERSION ${NL_VERSION_MAJOR}
  PROJECT_LABEL "Library: NeL Georges")

IF(WIN32)
  SET_TARGET_PROPERTIES(nelgeorges PROPERTIES COMPILE_FLAGS "/Yustdgeorges.h")
  SET_SOURCE_FILES_PROPERTIES(stdgeorges.cpp PROPERTIES COMPILE_FLAGS "/Ycstdgeorges.h")
  SET_TARGET_PROPERTIES(nelgeorges PROPERTIES 
    LINK_FLAGS "/NODEFAULTLIB:libcmt"
    DEBUG_POSTFIX "_d"
    RELEASE_POSTFIX "_r")
ENDIF(WIN32)

ADD_DEFINITIONS(${LIBXML2_DEFINITIONS})

INSTALL(TARGETS nelgeorges LIBRARY DESTINATION lib ARCHIVE DESTINATION lib COMPONENT libraries)
